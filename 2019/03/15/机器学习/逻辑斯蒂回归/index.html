<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">

<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Anjhon">


    <meta name="subtitle" content="å°å®‰">


    <meta name="description" content="ä½›ç³»åˆ†äº«">



<title>é€»è¾‘æ–¯è’‚å›å½’(Logistic) | Anjhon</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    





    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    





    
    
        
            <!-- MathJaxé…ç½®ï¼Œå¯é€šè¿‡å•ç¾å…ƒç¬¦å·ä¹¦å†™è¡Œå†…å…¬å¼ç­‰ -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- ç»™MathJaxå…ƒç´ æ·»åŠ has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- é€šè¿‡è¿æ¥CDNåŠ è½½MathJaxçš„jsä»£ç  -->
<script type="text/javascript" async
        
		src="https://cdn.jsdelivr.net/npm/mathjax@2.7.8/unpacked/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


        
    


<meta name="generator" content="Hexo 4.1.1"></head>
<body>

	
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Anjhon</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">åšæ–‡</a>
                
                    <a class="menu-item" href="/category">åˆ†ç±»</a>
                
                    <a class="menu-item" href="/tag">æ ‡ç­¾</a>
                
                    <a class="menu-item" href="/about">å…³äº</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Anjhon</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">åšæ–‡</a>
                
                    <a class="menu-item" href="/category">åˆ†ç±»</a>
                
                    <a class="menu-item" href="/tag">æ ‡ç­¾</a>
                
                    <a class="menu-item" href="/about">å…³äº</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">å±•å¼€å…¨éƒ¨</a>
        <a onclick="go_top()">å›åˆ°é¡¶éƒ¨</a>
        <a onclick="go_bottom()">ä¸‹åˆ°åº•éƒ¨</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "æŠ˜å èµ·æ¥"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "å±•å¼€å…¨éƒ¨"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">é€»è¾‘æ–¯è’‚å›å½’(Logistic)</h1>
            
                <div class="post-meta">
                    <br>
                    
                        ä½œè€…: <a itemprop="author" rel="author" href="/">&nbsp;&nbsp;Anjhon</a>
                    

                    
                        <p class="post-time">
                        å‘è¡¨: <a href="#">&nbsp;&nbsp;2019-03-15</a>
                        </p>
                    
                    
                        <p class="post-category">
                    åˆ†ç±»:
                            
                                <a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">&nbsp;&nbsp;æœºå™¨å­¦ä¹ </a>
                            
                            </p>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="ä¸€-é€»è¾‘æ–¯è’‚å›å½’åŸç†"><a href="#ä¸€-é€»è¾‘æ–¯è’‚å›å½’åŸç†" class="headerlink" title="ä¸€: é€»è¾‘æ–¯è’‚å›å½’åŸç†"></a>ä¸€: é€»è¾‘æ–¯è’‚å›å½’åŸç†</h1><h2 id="ä¸€-ä¼¼ç„¶å‡½æ•°"><a href="#ä¸€-ä¼¼ç„¶å‡½æ•°" class="headerlink" title="(ä¸€): ä¼¼ç„¶å‡½æ•°"></a>(ä¸€): ä¼¼ç„¶å‡½æ•°</h2><p>æ¯ä¸ªæ ·æœ¬çš„æ¦‚ç‡:<br>$$<br>P(y|x;\theta)=(h_{\theta}(x))^y(1-h_\theta (x))^{1-y}<br>$$<br>äº‹ä»¶çš„æ¦‚ç‡(æ‰€æœ‰æ ·æœ¬å±äºçœŸå®æ ‡è®°çš„æ¦‚ç‡)<br>$$<br>L(\theta)= \prod_{i=1}^nP(y_i|x_i;\theta)<br>$$</p>
<p>$$<br>L(\theta)= \prod_{i=1}^n(h_{\theta}(x_i))^{y_i}(1-h_\theta (x_i))^{1-{y_i}}<br>$$</p>
<p><strong>ä¼¼ç„¶å‡½æ•°è§£å†³äºŒåˆ†ç±»é—®é¢˜:</strong></p>
<p>å½“y=1æ—¶:<br>$$<br>P(1|x_i;\theta)=(h_{\theta}(x_i))^1(1-h_\theta (x_i))^{1-1}<br>$$</p>
<p>$$<br>P(1|x_i;\theta)=h_{\theta}(x_i)<br>$$</p>
<p>å½“y=0æ—¶:<br>$$<br>P(0|x_i;\theta)=(h_{\theta}(x_i))^0(1-h_\theta (x_i))^{1-0}<br>$$</p>
<p>$$<br>P(0|x_i;\theta)=1-h_\theta (x_i)<br>$$</p>
<p><strong>ä¸¾ä¸ªæ —å­:</strong> </p>
<p>å‡å¦‚æœ‰ä¸€ä¸ªç½å­ï¼Œé‡Œé¢æœ‰é»‘ç™½ä¸¤ç§é¢œè‰²çš„çƒï¼Œæ•°ç›®å¤šå°‘ä¸çŸ¥ï¼Œä¸¤ç§é¢œè‰²çš„æ¯”ä¾‹ä¹Ÿä¸çŸ¥ã€‚æˆ‘ä»¬æƒ³çŸ¥é“ç½ä¸­ç™½çƒå’Œé»‘çƒçš„æ¯”ä¾‹ï¼Œä½†æˆ‘ä»¬ä¸èƒ½æŠŠç½ä¸­çš„çƒå…¨éƒ¨æ‹¿å‡ºæ¥æ•°ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥æ¯æ¬¡ä»»æ„ä»å·²ç»æ‘‡åŒ€çš„ç½ä¸­æ‹¿ä¸€ä¸ªçƒå‡ºæ¥ï¼Œè®°å½•çƒçš„é¢œè‰²ï¼Œç„¶åæŠŠæ‹¿å‡ºæ¥çš„çƒå†æ”¾å›ç½ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥é‡å¤ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è®°å½•çš„çƒçš„é¢œè‰²æ¥ä¼°è®¡ç½ä¸­é»‘ç™½çƒçš„æ¯”ä¾‹ã€‚å‡å¦‚åœ¨å‰é¢çš„ä¸€ç™¾æ¬¡é‡å¤è®°å½•ä¸­ï¼Œæœ‰ä¸ƒåæ¬¡æ˜¯ç™½çƒï¼Œè¯·é—®ç½ä¸­ç™½çƒæ‰€å çš„æ¯”ä¾‹æœ€æœ‰å¯èƒ½æ˜¯å¤šå°‘ï¼Ÿ</p>
<p>è§£: </p>
<p>è®¾æ¯æ¬¡å–åˆ°ç™½çƒçš„æ¦‚ç‡ä¸ºp, åˆ™å–åˆ°é»‘çƒçš„æ¦‚ç‡ä¸º(1-p), åˆ™100æ¬¡ä¸­70æ¬¡å–åˆ°ç™½çƒçš„æ¦‚ç‡ä¸º:<br>$$<br>P=C_{100}^{70}p^{70}(1-p)^{30}<br>$$</p>
<p>$$<br>Pâ€™=(p^{70})â€™(1-p)^{30}+p^{70}((1-p)^{30})â€™\times(1-p)â€™<br>$$</p>
<p>$$<br>Pâ€™=70p^{69}(1-p)^{30}-p^{70}30(1-p)^{29}<br>$$</p>
<p>æ­¤æ—¶ä»¤å¯¼æ•°ä¸ºé›¶æ±‚æœ€å¤§å€¼:<br>$$<br>0=70p^{69}(1-p)^{30}-p^{70}30(1-p)^{29}<br>$$<br>åŒ–ç®€:<br>$$<br>0=70(1-p)-30p<br>$$</p>
<p>$$<br>100p=70<br>$$</p>
<p>æ‰€ä»¥:<br>$$<br>p=70\div100<br>$$</p>
<h2 id="äºŒ-é€»è¾‘æ–¯è’‚å›å½’åŸç†å’ŒæŸå¤±å‡½æ•°"><a href="#äºŒ-é€»è¾‘æ–¯è’‚å›å½’åŸç†å’ŒæŸå¤±å‡½æ•°" class="headerlink" title="(äºŒ): é€»è¾‘æ–¯è’‚å›å½’åŸç†å’ŒæŸå¤±å‡½æ•°"></a>(äºŒ): é€»è¾‘æ–¯è’‚å›å½’åŸç†å’ŒæŸå¤±å‡½æ•°</h2><p>åˆ†ç±»é—®é¢˜å…¶å®éƒ½æ˜¯æ¦‚ç‡é—®é¢˜, é€»è¾‘æ–¯è’‚å‡½æ•°å°±æ˜¯æ¦‚ç‡å‡½æ•°,æ— è®ºç»™çš„å€¼å¤šå¤§å¤šå°éƒ½ä¼šè½¬å˜åˆ°0-1ä¹‹é—´è¿›è¡Œæ¯”è¾ƒ,å¹¶å¾—å‡ºæ¦‚ç‡è¿›è¡Œåˆ†ç±»</p>
<p><strong>sigmoidå‡½æ•°:</strong><br>$$<br>S(t) = \frac{1}{1+e^{-t}}<br>$$<br><strong>çº¿æ€§å›å½’æ–¹ç¨‹:</strong><br>$$<br>ä¸€èˆ¬æ¨¡å¼: f(x) = {\theta}x+b<br>$$</p>
<p>$$<br>çŸ©é˜µæ¨¡å¼: f(X) = \sum\limits _{i=1}^nx_i{\theta}_i+b<br>$$</p>
<h3 id="1-é€»è¾‘æ–¯è’‚å›å½’åŸç†"><a href="#1-é€»è¾‘æ–¯è’‚å›å½’åŸç†" class="headerlink" title="1: é€»è¾‘æ–¯è’‚å›å½’åŸç†"></a>1: é€»è¾‘æ–¯è’‚å›å½’åŸç†</h3><p><font color=red><strong>é€»è¾‘æ–¯è’‚å›å½’ = çº¿æ€§å›å½’ + sigmoid</strong></font></p>
<p><strong>æ–¹ç¨‹ç»“åˆ - é¢„æµ‹å‡½æ•°:</strong><br>$$<br>ä¸€èˆ¬å½¢å¼: h_{\theta}(x)=\frac{1}{1+e^{-x\theta}}<br>$$</p>
<p>$$<br>çŸ©é˜µæ¨¡å¼: h_{\theta}(X)=\frac{1}{1+e^{-X\theta}}<br>$$</p>
<h3 id="2-æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ³•æ±‚æŸå¤±å‡½æ•°"><a href="#2-æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ³•æ±‚æŸå¤±å‡½æ•°" class="headerlink" title="2: æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ³•æ±‚æŸå¤±å‡½æ•°"></a>2: æœ€å¤§ä¼¼ç„¶ä¼°è®¡æ³•æ±‚æŸå¤±å‡½æ•°</h3><p><strong>æœ€å¤§ä¼¼ç„¶ä¼°è®¡å…¬å¼æ±‚å¯¹æ•°:</strong><br>$$<br>l(\theta) = ln(L(\theta)) =ln[ \prod_{i=1}^n(h_{\theta}(x_i))^{y_i}(1-h_\theta (x_i))^{1-{y_i}}]<br>$$<br><strong>ä¹˜ç§¯çš„å¯¹æ•°å¯ä»¥è½¬æ¢æˆåŠ æ³•:</strong><br>$$<br>l(\theta)= \sum_{i=1}^n[y_iln(h_{\theta}(x_i))+(1-{y_i})ln(1-h_\theta (x_i))]<br>$$<br>æœ€å¤§ä¼¼ç„¶ä¼°è®¡å°±æ˜¯è¦æ±‚å¾—ä½¿ $l(\theta)$ å–æœ€å¤§å€¼æ—¶çš„ $\theta$ ï¼Œå…¶å®è¿™é‡Œå¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸Šå‡æ³•æ±‚è§£ï¼Œæ±‚å¾—çš„ $\theta$ å°±æ˜¯è¦æ±‚çš„æœ€ä½³å‚æ•°</p>
<p><strong>å¯¹ä¼¼ç„¶å‡½æ•°å¯¹æ•°åŒ–å–åçš„è¡¨è¾¾å¼ï¼Œå³æŸå¤±å‡½æ•°è¡¨è¾¾å¼</strong><br>$$<br>J(\theta) = -l(\theta) = -\sum_{i=1}^n[y_iln(h_{\theta}(x_i))+(1-{y_i})ln(1-h_\theta (x_i))]<br>$$</p>
<blockquote>
<p><strong>æŸå¤±å‡½æ•° $J(\theta)$ å¯¹ $ \theta$ æ±‚å¯¼:</strong></p>
</blockquote>
<p>$$<br>Jâ€™(\theta) = \frac{\partial J(\theta)}{\partial\theta}<br>$$</p>
<p>$$<br>\begin{aligned}<br>\frac{\partial J(\theta)}{\partial\theta} &amp; =  -\sum_{i=1}^n[y_i\frac{1}{h_{\theta}(x_i)}\frac{\partial h_\theta(x_i)}{\partial\theta}+(1-{y_i})\frac{1}{1-h_\theta (x_i)}\frac{\partial (1-h_\theta(x_i))}{\partial\theta}]\\<br>&amp; \\<br>&amp; æ³¨é‡Š: ln(x)â€™=\frac{1}{x}\\<br>&amp; \\<br>&amp; =  -\sum_{i=1}^n[y_i\frac{1}{h_{\theta}(x_i)}\frac{\partial h_\theta(x_i)}{\partial\theta}-(1-{y_i})\frac{1}{1-h_\theta (x_i)}\frac{\partial h_\theta(x_i)}{\partial\theta}]\\<br>&amp; =  -\sum_{i=1}^n[y_i\frac{1}{h_{\theta}(x_i)}-(1-{y_i})\frac{1}{1-h_\theta (x_i)}]\frac{\partial h_\theta(x_i)}{\partial\theta}\\<br>&amp;\\<br>&amp; æ³¨é‡Š: \frac{\partial h_\theta(x_i)}{\partial\theta}çš„æ¨å¯¼è¿‡ç¨‹è¯¦è§ä¸‹æ–‡\\<br>&amp;\\<br>&amp; =  -\sum_{i=1}^n[y_i\frac{1}{h_{\theta}(x_i)}-(1-{y_i})\frac{1}{1-h_\theta (x_i)}]x_ih_\theta(x_i)(1-h_\theta(x_i))\\<br>&amp; =  -\sum_{i=1}^n[y_i(1-h_\theta (x_i))-(1-{y_i})h_\theta (x_i)]x_i\\<br>&amp; =  -\sum_{i=1}^n[y_i-h_\theta (x_i)]x_i\\<br>&amp; =  \sum_{i=1}^n[h_\theta (x_i)-y_i]x_i\\<br>\end{aligned}<br>$$</p>
<p><strong>æ¨å¯¼ $\frac{\partial h_\theta(x_i)}{\partial\theta}$ çš„è¿‡ç¨‹:</strong><br>$$<br>\begin{aligned}<br>\frac{\partial h_\theta(x_i)}{\partial\theta}&amp; =  hâ€™_\theta(x_i)\\<br>&amp; =  (\frac{1}{1+e^{-x_i\theta}})â€™\\<br>&amp; =  (\frac{1}{1+e^{-\theta^Tx_i}})â€™\\<br>&amp; =  [(1+e^{-\theta^Tx_i})^{-1}]â€™\\<br>&amp; æ³¨é‡Š: (e^x)â€™ = e^x \\<br>&amp; =  -(1+e^{-\theta^Tx_i})^{-2}e^{-\theta^Tx_i}(-x_i)\\<br>&amp; =  (1+e^{-\theta^Tx_i})^{-2}e^{-\theta^Tx_i}x_i\\<br>&amp; =  x_i\frac{e^{-\theta^Tx_i}}{(1+e^{-\theta^Tx_i})^2}\\<br>&amp; =  x_i\frac{1}{(1+e^{-\theta^Tx_i})}\frac{e^{-\theta^Tx_i}}{(1+e^{-\theta^Tx_i})}\\<br>&amp; =  x_ih_\theta(x_i)\frac{e^{-\theta^Tx_i}}{(1+e^{-\theta^Tx_i})}\\<br>&amp; =  x_ih_\theta(x_i)\frac{1+e^{-\theta^Tx_i}-1}{(1+e^{-\theta^Tx_i})}\\<br>&amp; =  x_ih_\theta(x_i)[\frac{1+e^{-\theta^Tx_i}}{(1+e^{-\theta^Tx_i})}-\frac{1}{(1+e^{-\theta^Tx_i})}]\\<br>&amp; =  x_ih_\theta(x_i)[1-\frac{1}{(1+e^{-\theta^Tx_i})}]\\<br>&amp; =  x_ih_\theta(x_i)(1-h_\theta(x_i))\\<br>\end{aligned}<br>$$</p>
<p><strong>æ­¤æ—¶ä½¿ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–ç®—æ³•, å…¶ç³»æ•°çš„æ›´æ–°è§„åˆ™ä¸º:</strong><br>$$<br>\theta = \theta - \epsilon\frac{\partial J(\theta)}{\partial\theta}<br>$$</p>
<h1 id="äºŒ-é€»è¾‘æ–¯è’‚å›å½’çš„åº”ç”¨"><a href="#äºŒ-é€»è¾‘æ–¯è’‚å›å½’çš„åº”ç”¨" class="headerlink" title="äºŒ: é€»è¾‘æ–¯è’‚å›å½’çš„åº”ç”¨"></a>äºŒ: é€»è¾‘æ–¯è’‚å›å½’çš„åº”ç”¨</h1><h2 id="ä¸€-ç®€å•åº”ç”¨-é¸¢å°¾èŠ±åˆ†ç±»"><a href="#ä¸€-ç®€å•åº”ç”¨-é¸¢å°¾èŠ±åˆ†ç±»" class="headerlink" title="(ä¸€): ç®€å•åº”ç”¨ - é¸¢å°¾èŠ±åˆ†ç±»"></a>(ä¸€): ç®€å•åº”ç”¨ - é¸¢å°¾èŠ±åˆ†ç±»</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets, metrics</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¸¢å°¾èŠ±æ•°æ®</span></span><br><span class="line">iris = datasets.load_iris()</span><br><span class="line"></span><br><span class="line"><span class="comment"># èŠ±è¼é•¿åº¦, èŠ±è¼å®½åº¦, èŠ±ç“£é•¿åº¦, èŠ±ç“£å®½åº¦</span></span><br><span class="line">X = iris[<span class="string">'data'</span>]</span><br><span class="line">y = iris[<span class="string">'target'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># train_test_splitéšæœºæ‰“ä¹±æ•°æ®é¡ºåº, random_stateä½¿å¾—æ¯æ¬¡éšæœºçš„æ•°å€¼æ˜¯ä¸€æ ·çš„</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">lr = LogisticRegression(max_iter=<span class="number">1000</span>)   <span class="comment"># max_iter=1000, å­¦ä¹ æ¬¡æ•°</span></span><br><span class="line">lr.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_ = lr.predict(X_test)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'å®é™…æ•°æ®:y_test:\n'</span>, y_test)</span><br><span class="line">print(<span class="string">'é¢„æµ‹æ•°æ®:y_:\n'</span>, y_)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">å®é™…æ•°æ®:y_test:</span></span><br><span class="line"><span class="string"> [0 1 1 1 2 0 0 2 0 2 1 1 1 0 2 0 2 0 1 1 0 1 0 1 0 2 1 1 1 2]</span></span><br><span class="line"><span class="string">é¢„æµ‹æ•°æ®:y_:</span></span><br><span class="line"><span class="string"> [0 1 1 2 2 0 0 2 0 2 1 1 1 0 2 0 2 0 1 1 0 1 0 2 0 2 1 1 1 2]</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>



<h2 id="äºŒ-äºŒåˆ†ç±»é—®é¢˜"><a href="#äºŒ-äºŒåˆ†ç±»é—®é¢˜" class="headerlink" title="(äºŒ): äºŒåˆ†ç±»é—®é¢˜"></a>(äºŒ): äºŒåˆ†ç±»é—®é¢˜</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">X,y = datasets.load_iris(<span class="literal">True</span>)   <span class="comment"># Trueä»£è¡¨åªè·å–æ•°æ®å’Œç›®æ ‡å€¼</span></span><br><span class="line"></span><br><span class="line">cond = y!=<span class="number">0</span>   <span class="comment"># åªç•™ä¸‹ä¸¤ä¸ªç±»åˆ«,å°†ç±»åˆ«0 åˆ é™¤</span></span><br><span class="line">X = X[cond]</span><br><span class="line">y = y[cond]</span><br><span class="line"></span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(X,y)  <span class="comment"># ç®—æ³•ï¼Œè®­ç»ƒæ•°æ®ï¼Œæ‰¾Xå’Œyä¹‹é—´çš„è§„å¾‹ï¼Œæ–¹ç¨‹</span></span><br><span class="line">y_ = lr.predict(X)  <span class="comment"># è§„å¾‹æ‰¾åˆ°ä¹‹åï¼Œä½¿ç”¨è§„å¾‹ï¼Œè¿›è¡Œè®¡ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†ç±»åˆ«å‡å°‘ä¹‹å, åˆ†ç±»åçš„ç»“æœå’ŒçœŸå®å€¼ç›¸å·®å¾ˆå°,è¯´æ˜ç±»åˆ«è¶Šå°‘,åˆ†ç±»çš„å‡†ç¡®åº¦è¶Šé«˜</span></span><br><span class="line"></span><br><span class="line">(y_ == y).mean()   <span class="comment"># è®¡ç®—å‡†ç¡®ç‡</span></span><br><span class="line">print(y_)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1,</span></span><br><span class="line"><span class="string">       1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,</span></span><br><span class="line"><span class="string">       1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,</span></span><br><span class="line"><span class="string">       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,</span></span><br><span class="line"><span class="string">       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">proba_ = lr.predict_proba(X)   <span class="comment"># è®¡ç®—çš„æ¦‚ç‡</span></span><br><span class="line">proba_[:<span class="number">10</span>]   <span class="comment"># å°†æ¦‚ç‡è½¬åŒ–æˆç±»åˆ«</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">array([[0.99153216, 0.00846784],</span></span><br><span class="line"><span class="string">       [0.9908928 , 0.0091072 ],</span></span><br><span class="line"><span class="string">       [0.99355185, 0.00644815],</span></span><br><span class="line"><span class="string">       [0.99086387, 0.00913613],</span></span><br><span class="line"><span class="string">       [0.99219814, 0.00780186],</span></span><br><span class="line"><span class="string">       [0.98268555, 0.01731445],</span></span><br><span class="line"><span class="string">       [0.99252002, 0.00747998],</span></span><br><span class="line"><span class="string">       [0.9899949 , 0.0100051 ],</span></span><br><span class="line"><span class="string">       [0.99259338, 0.00740662],</span></span><br><span class="line"><span class="string">       [0.99028393, 0.00971607]])</span></span><br><span class="line"><span class="string">æ¯ç»„æ•°æ®æœ‰ä¸¤ç§åˆ†ç±»çš„å¯èƒ½æ€§, æ¯ç§å¯èƒ½æ€§å¯¹åº”çš„æ¦‚ç‡ä¸åŒ,ç³»ç»Ÿåœ¨åˆ¤åˆ«çš„æ—¶å€™ä¼šé€‰æ‹©æ¦‚ç‡è¾ƒå¤§çš„é‚£ä¸ªç±»åˆ«</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">proba_.argmax(axis=<span class="number">1</span>)+<span class="number">1</span>   <span class="comment"># å°†æ¦‚ç‡è½¬æ¢ä¸ºç±»åˆ«; .argmax(axis=1)è·å–åŒä¸€è¡Œä¸­è¾ƒå¤§çš„å€¼(æ¦‚ç‡)çš„ä¸‹æ ‡;åŠ 1æ˜¯å› ä¸ºä¹‹å‰çš„ç±»åˆ«0å·²ç»è¢«åˆ é™¤äº†,è€Œè¿™é‡Œçš„ä¸‹æ ‡è¿˜æœ‰å¯èƒ½æ˜¯0</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1,</span></span><br><span class="line"><span class="string">       1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,</span></span><br><span class="line"><span class="string">       1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2,</span></span><br><span class="line"><span class="string">       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,</span></span><br><span class="line"><span class="string">       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2], dtype=int64)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸Šæ˜¯ç”¨ç®—æ³•æ¨¡å‹å¾—å‡ºçš„åˆ†ç±»ç»“æœ(y_)å’Œæ¦‚ç‡æ‰‹åŠ¨è®¡ç®—æ¦‚ç‡(proba_)ï¼Œç°åœ¨æˆ‘ä»¬ç”¨ä»£ç å®ç°ä»¥ä¸Šæ•ˆæœ:</span></span><br><span class="line">w_ = lr.coef_</span><br><span class="line">b_ = lr.intercept_</span><br><span class="line">print(<span class="string">'æ–¹ç¨‹ç³»æ•°'</span>,lr.coef_)</span><br><span class="line">print(<span class="string">'æ–¹ç¨‹æˆªè·'</span>,lr.intercept_)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">æ–¹ç¨‹ç³»æ•° [[ 0.48498493 -0.34086327  1.8278232   0.83365156]]</span></span><br><span class="line"><span class="string">æ–¹ç¨‹æˆªè· [-8.76905997]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fun</span><span class="params">(X)</span>:</span><span class="comment">#çº¿æ€§æ–¹ç¨‹ï¼ŒçŸ©é˜µï¼Œæ‰¹é‡è®¡ç®—</span></span><br><span class="line">    <span class="keyword">return</span> X.dot(w_[<span class="number">0</span>]) + b_[<span class="number">0</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sigmoid</span><span class="params">(x)</span>:</span><span class="comment">#funå°±æ˜¯çº¿æ€§æ–¹ç¨‹çš„è¿”å›å€¼</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>/(<span class="number">1</span>+np.e**-x)</span><br><span class="line"></span><br><span class="line">f = fun(X)</span><br><span class="line">p_1 = sigmoid(f)   <span class="comment"># æ±‚å‡ºäºŒåˆ†ç±»ä¸­ä¸€ç±»çš„æ¦‚ç‡</span></span><br><span class="line">p_0 = <span class="number">1</span> - p_1   <span class="comment"># æ±‚å‡ºäºŒåˆ†ç±»ä¸­å¦å¤–ä¸€ç±»çš„æ¦‚ç‡(äºŒåˆ†ç±»ä¸­å‡Œæ€»å¯èƒ½æ€§çš„å’Œä¸º1)</span></span><br><span class="line">p_ = np.c_[p_0,p_1]   <span class="comment"># å°†ä¸¤ä¸ªæ¦‚ç‡è¿æ¥èµ·æ¥</span></span><br><span class="line"><span class="comment"># np.r_ï¼šæ˜¯æŒ‰åˆ—è¿æ¥ä¸¤ä¸ªçŸ©é˜µï¼Œå°±æ˜¯æŠŠä¸¤çŸ©é˜µä¸Šä¸‹ç›¸åŠ ï¼Œè¦æ±‚åˆ—æ•°ç›¸ç­‰ï¼Œç±»ä¼¼äºpandasä¸­çš„concat()ã€‚</span></span><br><span class="line"><span class="comment"># np.c_ï¼šæ˜¯æŒ‰è¡Œè¿æ¥ä¸¤ä¸ªçŸ©é˜µï¼Œå°±æ˜¯æŠŠä¸¤çŸ©é˜µå·¦å³ç›¸åŠ ï¼Œè¦æ±‚è¡Œæ•°ç›¸ç­‰ï¼Œç±»ä¼¼äºpandasä¸­çš„merge()ã€‚</span></span><br><span class="line"></span><br><span class="line">p_[:<span class="number">10</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">array([[0.99153216, 0.00846784],</span></span><br><span class="line"><span class="string">       [0.9908928 , 0.0091072 ],</span></span><br><span class="line"><span class="string">       [0.99355185, 0.00644815],</span></span><br><span class="line"><span class="string">       [0.99086387, 0.00913613],</span></span><br><span class="line"><span class="string">       [0.99219814, 0.00780186],</span></span><br><span class="line"><span class="string">       [0.98268555, 0.01731445],</span></span><br><span class="line"><span class="string">       [0.99252002, 0.00747998],</span></span><br><span class="line"><span class="string">       [0.9899949 , 0.0100051 ],</span></span><br><span class="line"><span class="string">       [0.99259338, 0.00740662],</span></span><br><span class="line"><span class="string">       [0.99028393, 0.00971607]])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># å¯¹æ¯”å‘ç°p_å’Œproba_æ‰€å¾—åˆ°çš„ç»“æœæ˜¯ä¸€è‡´çš„;</span></span><br></pre></td></tr></table></figure>



<h2 id="ä¸‰-å¤šåˆ†ç±»é—®é¢˜"><a href="#ä¸‰-å¤šåˆ†ç±»é—®é¢˜" class="headerlink" title="(ä¸‰): å¤šåˆ†ç±»é—®é¢˜"></a>(ä¸‰): å¤šåˆ†ç±»é—®é¢˜</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets, metrics</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">X,y = datasets.load_iris(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“ä¹±é¡ºåº</span></span><br><span class="line">index = np.arange(<span class="number">150</span>)</span><br><span class="line">np.random.shuffle(index)</span><br><span class="line">X = X[index]</span><br><span class="line">y = y[index]</span><br><span class="line"></span><br><span class="line">lr = LogisticRegression(max_iter=<span class="number">200</span>)   <span class="comment"># å®šä¹‰æ¨¡å‹</span></span><br><span class="line">lr.fit(X,y)   <span class="comment"># è®­ç»ƒæ¨¡å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¯3åˆ†ç±»é—®é¢˜, ä¸‰ä¸ªæ–¹ç¨‹(æ¯ä¸€ç±»å¯¹åº”ä¸€ä¸ªæ–¹ç¨‹),ä¸‰ç»„æ–œç‡,æ¯ç»„æ–œç‡æœ‰4ä¸ªå±æ€§; ä¸‰ä¸ªæˆªè·, </span></span><br><span class="line">w_ = lr.coef_</span><br><span class="line">b_ = lr.intercept_</span><br><span class="line">print(<span class="string">'æ–œç‡:\n'</span>,w_)</span><br><span class="line">print(<span class="string">'æˆªè·:\n'</span>,b_)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">æ–œç‡:</span></span><br><span class="line"><span class="string"> [[-0.42294389  0.9669724  -2.51691851 -1.08061335]</span></span><br><span class="line"><span class="string"> [ 0.53406236 -0.32159608 -0.20649198 -0.94361292]</span></span><br><span class="line"><span class="string"> [-0.11111847 -0.64537632  2.72341049  2.02422627]]</span></span><br><span class="line"><span class="string">æˆªè·:</span></span><br><span class="line"><span class="string"> [  9.84788649   2.2391674  -12.08705389]</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">y_ = lr.predict(X)</span><br><span class="line">proba_ = lr.predict_proba(X)   <span class="comment"># æ¦‚ç‡</span></span><br><span class="line">print(<span class="string">'y_:\n'</span>, y_)</span><br><span class="line">print(<span class="string">'proba_:\n'</span>, proba_)</span><br><span class="line">print(proba_.argmax(axis = <span class="number">1</span>))   <span class="comment"># argmaxè·å–æœ€å¤§å€¼çš„ä¸‹æ ‡(ç±»åˆ«)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">y_:</span></span><br><span class="line"><span class="string"> [2 0 1 2 1 1 0 0 2 1 2 2 1 1 1 0 0 0 0 1 2 1 2 2 2 2 2 0 1 0 2 1 1 1 2 0 0</span></span><br><span class="line"><span class="string"> 2 0 1 2 1 2 0 1 2 2 0 1 0 0 2 0 2 0 1 1 1 0 0 0 2 1 1 1 0 0 2 0 2 2 2 2 1</span></span><br><span class="line"><span class="string"> 0 1 0 1 2 1 0 2 1 1 2 0 2 1 0 2 1 2 0 1 0 0 2 1 2 1 0 1 0 0 0 1 1 2 1 2 1</span></span><br><span class="line"><span class="string"> 1 1 2 0 2 0 2 1 0 0 2 0 0 2 1 0 0 2 1 1 2 0 2 2 2 0 1 2 2 0 0 0 2 2 0 1 2</span></span><br><span class="line"><span class="string"> 1 2]</span></span><br><span class="line"><span class="string">proba_:</span></span><br><span class="line"><span class="string"> [[2.42893049e-04 1.62572543e-01 8.37184564e-01]</span></span><br><span class="line"><span class="string"> [9.76236359e-01 2.37636218e-02 1.93734447e-08]</span></span><br><span class="line"><span class="string"> [1.02308731e-02 7.50874989e-01 2.38894138e-01]</span></span><br><span class="line"><span class="string"> [6.22245105e-07 2.13422648e-02 9.78657113e-01]</span></span><br><span class="line"><span class="string"> ......</span></span><br><span class="line"><span class="string"> [9.08742683e-03 9.76589206e-01 1.43233676e-02]</span></span><br><span class="line"><span class="string"> [1.06469379e-06 2.91941988e-02 9.70804737e-01]</span></span><br><span class="line"><span class="string"> [2.43372229e-01 7.55336793e-01 1.29097800e-03]</span></span><br><span class="line"><span class="string"> [2.27109807e-04 2.51919829e-01 7.47853061e-01]]</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> proba_.argmax(axis = 1):</span></span><br><span class="line"><span class="string"> array([2, 0, 1, 2, 1, 1, 0, 0, 2, 1, 2, 2, 1, 1, 1, 0, 0, 0, 0, 1, 2, 1,</span></span><br><span class="line"><span class="string">       2, 2, 2, 2, 2, 0, 1, 0, 2, 1, 1, 1, 2, 0, 0, 2, 0, 1, 2, 1, 2, 0,</span></span><br><span class="line"><span class="string">       1, 2, 2, 0, 1, 0, 0, 2, 0, 2, 0, 1, 1, 1, 0, 0, 0, 2, 1, 1, 1, 0,</span></span><br><span class="line"><span class="string">       0, 2, 0, 2, 2, 2, 2, 1, 0, 1, 0, 1, 2, 1, 0, 2, 1, 1, 2, 0, 2, 1,</span></span><br><span class="line"><span class="string">       0, 2, 1, 2, 0, 1, 0, 0, 2, 1, 2, 1, 0, 1, 0, 0, 0, 1, 1, 2, 1, 2,</span></span><br><span class="line"><span class="string">       1, 1, 1, 2, 0, 2, 0, 2, 1, 0, 0, 2, 0, 0, 2, 1, 0, 0, 2, 1, 1, 2,</span></span><br><span class="line"><span class="string">       0, 2, 2, 2, 0, 1, 2, 2, 0, 0, 0, 2, 2, 0, 1, 2, 1, 2], dtype=int64)</span></span><br><span class="line"><span class="string">       </span></span><br><span class="line"><span class="string">ä»¥ä¸Šproba_.argmax(axis = 1)çš„åˆ†ç±»ç»“æœå’Œæ¨¡å‹é¢„æµ‹çš„ç»“æœä¸€è‡´;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è®¡ç®—</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰çº¿æ€§å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear</span><span class="params">(x)</span>:</span></span><br><span class="line">    y = x.dot(w_.T)+b_</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†çš„åˆ°çš„ç›®æ ‡å€¼è½¬æ¢æˆæ¦‚ç‡(åŒä¸€ç»„ç›®æ ‡å€¼å†…çš„æ¦‚ç‡å’Œä¸º1)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">softmax</span><span class="params">(x)</span>:</span>   <span class="comment"># è¯¦ç»†å…¬å¼è§ä¸‹æ–‡</span></span><br><span class="line">    <span class="keyword">return</span> np.e**x/((np.e**x).sum(axis=<span class="number">1</span>).reshape(<span class="number">-1</span>,<span class="number">1</span>))</span><br><span class="line">    <span class="comment"># reshapeä¹‹ååˆ†æ¯çš„å½¢çŠ¶ç”±å•ç‹¬çš„ä¸€è¡Œ,å˜æˆä¸€åˆ—;å˜æˆä¸€åˆ—ä¹‹åå›æ ¹æ®åˆ†å­çš„å½¢çŠ¶ç”±ç¬¬ä¸€åˆ—è¿›è¡Œå¹¿æ’­(å¹¿æ’­å‡ºæ¥çš„åˆ—å’ŒåŸæ¥çš„ä¸€åˆ—ç›¸åŒ,åªæ˜¯ä¸ºäº†å¯¹åº”åˆ†æ”¯çš„æ•°æ®å½¢çŠ¶,æ–¹ä¾¿è¿›è¡Œè¿ç®—)</span></span><br><span class="line">    <span class="comment"># å¦‚æœæˆ‘åªéœ€è¦ç‰¹å®šçš„è¡Œæ•°ï¼Œåˆ—æ•°æˆ‘æ— æ‰€è°“å¤šå°‘ï¼Œæˆ‘åªéœ€è¦æŒ‡å®šè¡Œæ•°ï¼Œåˆ—æ•°ç”¨-1ä»£æ›¿å°±è¡Œäº†ï¼Œè®¡ç®—æœºå¸®æˆ‘ç®—åº”è¯¥æœ‰å¤šå°‘åˆ—ï¼Œåä¹‹äº¦ç„¶ã€‚æ‰€ä»¥-1åœ¨è¿™é‡Œåº”è¯¥å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ­£æ•´æ•°é€šé…ç¬¦ï¼Œå®ƒä»£æ›¿ä»»ä½•æ­£æ•´æ•°ã€‚</span></span><br><span class="line">    </span><br><span class="line">y_pred = linear(X)</span><br><span class="line">y_pred = softmax(y_pred)</span><br><span class="line">y_pred[:<span class="number">10</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">array([[2.42893049e-04, 1.62572543e-01, 8.37184564e-01],</span></span><br><span class="line"><span class="string">       [9.76236359e-01, 2.37636218e-02, 1.93734447e-08],</span></span><br><span class="line"><span class="string">       [1.02308731e-02, 7.50874989e-01, 2.38894138e-01],</span></span><br><span class="line"><span class="string">       [6.22245105e-07, 2.13422648e-02, 9.78657113e-01],</span></span><br><span class="line"><span class="string">       [8.71627591e-03, 7.74658724e-01, 2.16625000e-01],</span></span><br><span class="line"><span class="string">       [5.07829679e-03, 9.20088614e-01, 7.48330891e-02],</span></span><br><span class="line"><span class="string">       [9.84437320e-01, 1.55626715e-02, 8.01740090e-09],</span></span><br><span class="line"><span class="string">       [9.85693639e-01, 1.43063452e-02, 1.55226004e-08],</span></span><br><span class="line"><span class="string">       [9.96558465e-05, 1.20579040e-01, 8.79321304e-01],</span></span><br><span class="line"><span class="string">       [2.39486316e-02, 9.59459247e-01, 1.65921216e-02]])</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># å¾—åˆ°çš„æ¦‚ç‡å’Œæ¨¡å‹è®¡ç®—çš„æ¦‚ç‡ç›¸åŒ</span></span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç æ®µä¸­softmax(x)ç”¨åˆ°çš„å…¬å¼:</p>
<p>softmaxå‡½æ•°çš„è®¡ç®—åŸç† :<br>$$<br>e^{x_i}\div\sum_{i=1}^n e^{x_i}<br>$$<br><img src="https://img-blog.csdn.net/20171127214016170?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcGlhb3h1ZXpob25n/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt=""></p>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>æ–‡ç« ä½œè€…:</span>
                        <span>Anjhon</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>æ–‡ç« åœ°å€:</span>
                        <span><a href="https://anjhon1994.github.io/2019/03/15/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E9%80%BB%E8%BE%91%E6%96%AF%E8%92%82%E5%9B%9E%E5%BD%92/">é€»è¾‘æ–¯è’‚å›å½’(Logistic)</a></span>
                    </p>
                
                
                
                     <p class="copyright-item">
                         <span>çµé­‚æ‹·é—®:</span>
                         <span>Do you believe in <strong>DESTINY<strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>æ–‡ç« æ ‡ç­¾:</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">â–¼ åŸºç¡€</a>
                    
                        <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">â–¼ æœºå™¨å­¦ä¹ </a>
                    
                        <a href="/tags/sklearn/">â–¼ sklearn</a>
                    
                        <a href="/tags/Logistic%E5%9B%9E%E5%BD%92/">â–¼ Logisticå›å½’</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">ã€è¿”å›ä¸Šä¸€å±‚ã€‘</a>
                <span>Â· </span>
                <a href="/">ã€å»å¾€é¦–é¡µã€‘</a>
            </div>
        </section>
        <section class="post-nav">
            	
                <a class="prev" rel="prev" href="/2019/08/10/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF/">ä¸Šä¸€ç¯‡ï¼šæœ´ç´ è´å¶æ–¯</a>
            
            
            <a class="next" rel="next" href="/2019/02/20/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/KNN%E7%AE%97%E6%B3%95/">ä¸‹ä¸€ç¯‡ï¼šKNNè¿‘é‚»ç®—æ³•</a>
            
			<br>

        </section>


		<br>
		
		
			<span>ç•™ä¸‹ä½ çš„ç—•è¿¹ğŸ˜€</span>
			<section id="comments" class="comments">
			  <style>
				.comments{margin:10px;padding:10px;background:#fff;bordercolor:0,0,0}
				@media screen and (max-width:900px){.comments{margin:auto;padding:20px;background:#fff;bordercolor:0,0,0}}
			  </style>
			  <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    var notify = 'false' == true ? true : false;
    var verify = 'false' == true ? true : false;
    new Valine({
        av: AV,
        el: '#vcomment',
        notify: notify,
        app_id: "d8Xy9CoRkV8wkjgNsf6IRqfe-gzGzoHsz",
        app_key: "ePiIX7dqVFpzeKkr4T1ixiah",
        placeholder: "ğŸˆğŸˆğŸˆ Just say say ...",
        avatar:"robohash",

		
		
		
    });
</script>

			</section>
		
		


    </article>
</div>





			
        </div>
		
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© 
		Anjhon | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a>
		
		
		
		
		</span>
    </div>
</footer>

    </div>
	


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/ Relative)","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":180,"height":350},"mobile":{"show":false},"react":{"opacityDefault":0.7}});</script></body>
</html>
