<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">

<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Anjhon">


    <meta name="subtitle" content="å°å®‰">


    <meta name="description" content="æ²¡æœ‰åšä¸åˆ°çš„äº‹,åªæ˜¯çœ‹ä½ æƒ³ä¸æƒ³åš">



<title>RedisåŠå…¶åº”ç”¨ | Anjhon</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    





    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    





    
    
        
    


<meta name="generator" content="Hexo 4.1.1"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Anjhon</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">åšæ–‡</a>
                
                    <a class="menu-item" href="/category">åˆ†ç±»</a>
                
                    <a class="menu-item" href="/tag">æ ‡ç­¾</a>
                
                    <a class="menu-item" href="/about">å…³äº</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Anjhon</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">åšæ–‡</a>
                
                    <a class="menu-item" href="/category">åˆ†ç±»</a>
                
                    <a class="menu-item" href="/tag">æ ‡ç­¾</a>
                
                    <a class="menu-item" href="/about">å…³äº</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">å±•å¼€å…¨éƒ¨</a>
        <a onclick="go_top()">å›åˆ°é¡¶éƒ¨</a>
        <a onclick="go_bottom()">ä¸‹åˆ°åº•éƒ¨</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "æŠ˜å èµ·æ¥"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "å±•å¼€å…¨éƒ¨"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">RedisåŠå…¶åº”ç”¨</h1>
            
                <div class="post-meta">
                    <br>
                    
                        ä½œè€…: <a itemprop="author" rel="author" href="/">&nbsp;&nbsp;Anjhon</a>
                    

                    
                        <p class="post-time">
                        å‘è¡¨: <a href="#">&nbsp;&nbsp;2019-12-27</a>
                        </p>
                    
                    
                        <p class="post-category">
                    åˆ†ç±»:
                            
                                <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">&nbsp;&nbsp;æ•°æ®åº“</a>
                            
                            </p>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>éå…³ç³»å‹æ•°æ®åº“Redis<br>Redisæ˜¯ä¸ºäº†å®ç°é«˜é€Ÿç¼“å­˜æœåŠ¡,å‡å°MySQLæ•°æ®åº“çš„å‹åŠ›</p>
<a id="more"></a>


<h1 id="LinuxæœåŠ¡èµ·åœ"><a href="#LinuxæœåŠ¡èµ·åœ" class="headerlink" title="LinuxæœåŠ¡èµ·åœ"></a>LinuxæœåŠ¡èµ·åœ</h1><p>CentOS<br>    systemctl start æœåŠ¡å   -&gt;   å¯åŠ¨<br>    systemctl stop æœåŠ¡å   -&gt;   åœæ­¢<br>    systemctl restart æœåŠ¡å   -&gt;   é‡å¯<br>    systemctl status æœåŠ¡å   -&gt;   æŸ¥çœ‹çŠ¶æ€<br>    systemctl enable æœåŠ¡å   -&gt;   å¼€æœºè‡ªå¯<br>    systemctl disable æœåŠ¡å   -&gt;   ç¦æ­¢è‡ªå¯</p>
<p>Ubuntu<br>    service æœåŠ¡å start   -&gt;   å¯åŠ¨</p>
<h1 id="è¿›ç¨‹æŸ¥æ€"><a href="#è¿›ç¨‹æŸ¥æ€" class="headerlink" title="è¿›ç¨‹æŸ¥æ€"></a>è¿›ç¨‹æŸ¥æ€</h1><p>ps -ef | grep â€œâ€  -&gt;  æœç´¢å…¨éƒ¨åŒ…å«å­—ç¬¦ä¸²çš„å†…å®¹<br>ps -ef | grep â€œâ€ | grep -v â€œgrepâ€ -&gt;  æœç´¢å…¨éƒ¨åŒ…å«å­—ç¬¦ä¸²çš„å†…å®¹å¹¶ä¸”è¿‡æ»¤æ‰åŒ…å«grepçš„å†…å®¹<br>ps -ef | grep -Eæ­£åˆ™è¡¨è¾¾å¼  -&gt;  æœç´¢å…¨éƒ¨åŒ…å«ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„å†…å®¹<br>xargs  -&gt;  å°†åˆ—å˜æˆè¡Œ<br>ps -ef | grep â€œredis-serverâ€ | grep -v â€œgrepâ€ | awk â€˜{print $2}â€™ | xargs kill  -&gt;  ç²¾å‡†æŸ¥æ€è¿›ç¨‹</p>
<p>pkill è¿›ç¨‹å  -&gt;  æ ¹æ®åå­—æ€æ‰è¿›ç¨‹<br>killall è¿›ç¨‹å  -&gt;  æ ¹æ®åå­—æ€æ‰è¿›ç¨‹</p>
<h1 id="rediså‘½ä»¤"><a href="#rediså‘½ä»¤" class="headerlink" title="rediså‘½ä»¤"></a>rediså‘½ä»¤</h1><p>ttl key â€”â€”&gt; æŸ¥çœ‹keyçš„å­˜æ´»æ—¶é—´<br>set key value ex N â€”â€”&gt; è®¾ç½®keyçš„å­˜æ´»æ—¶é—´ä¸ºNç§’<br>set key value px N â€”â€”&gt; è®¾ç½®keyçš„å­˜æ´»æ—¶é—´ä¸ºNæ¯«ç§’<br>shutdown  â€”â€”&gt; å…³é—­redisæœåŠ¡å™¨<br>shutdown save â€”â€”&gt; ä¿å­˜å¹¶å…³é—­redisæœåŠ¡å™¨<br>save â€”â€”&gt; ä¿å­˜<br>bgsave â€”â€”&gt; åå°ä¿å­˜<br>dbsize â€”â€”&gt; æŸ¥çœ‹æ•°æ®åº“å¤§å°<br>keys *  â€”â€”&gt; è·å–æ‰€æœ‰çš„key<br>keys ta*  â€”â€”&gt; è·å–taå¼€å¤´çš„key</p>
<p><strong>redisé»˜è®¤å¼€å¯äº†16ä¸ªæ•°æ®åº“</strong><br>select 0-15 â€”â€”&gt; åˆ‡æ¢æ•°æ®åº“<br>flushdb â€”â€”&gt; æ¸…ç©ºå½“å‰æ•°æ®åº“<br>flushall â€”â€”&gt; æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“</p>
<p>type keyp â€”â€”&gt; åˆ¤æ–­keyçš„ç±»å‹</p>
<h1 id="redisçš„æ•°æ®ç±»å‹"><a href="#redisçš„æ•°æ®ç±»å‹" class="headerlink" title="redisçš„æ•°æ®ç±»å‹"></a>redisçš„æ•°æ®ç±»å‹</h1><h2 id="1-å­—ç¬¦ä¸²-string"><a href="#1-å­—ç¬¦ä¸²-string" class="headerlink" title="1.å­—ç¬¦ä¸² - string"></a>1.å­—ç¬¦ä¸² - string</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">key</span> <span class="keyword">value</span></span><br><span class="line"><span class="keyword">get</span> <span class="keyword">key</span></span><br><span class="line">strlen <span class="keyword">key</span></span><br><span class="line">append <span class="keyword">key</span> <span class="keyword">value</span> <span class="comment">------&gt; è¿½åŠ </span></span><br><span class="line">mset key1 value1 key2 value2 ... <span class="comment">------&gt; åŒæ—¶è®¾ç½®å¤šç»„å€¼</span></span><br><span class="line">mget key1 key2 ...</span><br><span class="line">incr <span class="keyword">key</span> <span class="comment">------&gt; å½“keyçš„å€¼ä¸ºæ•°å­—æ—¶,æ•°å€¼åŠ ä¸€</span></span><br><span class="line">incrby <span class="keyword">key</span> N <span class="comment">------&gt; ä¸ºkeyçš„å€¼åŠ N</span></span><br><span class="line">decr <span class="keyword">key</span> <span class="comment">------&gt; å‡ä¸€</span></span><br><span class="line">decrby <span class="keyword">key</span> N <span class="comment">------&gt; å‡N</span></span><br><span class="line">getrange <span class="keyword">key</span> m n <span class="comment">------&gt; ä»må–åˆ°n</span></span><br><span class="line">setrange <span class="keyword">key</span> N <span class="keyword">value</span> <span class="comment">------&gt; ä»nå¼€å§‹ç”¨valueè¦†ç›–keyçš„valueå€¼</span></span><br></pre></td></tr></table></figure>
<h2 id="2-å“ˆå¸Œ-hash"><a href="#2-å“ˆå¸Œ-hash" class="headerlink" title="2.å“ˆå¸Œ - hash"></a>2.å“ˆå¸Œ - hash</h2><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hset <span class="built_in">key</span> field <span class="built_in">value</span> è®¾ç½®é”®å’Œå€¼</span><br><span class="line">hmset <span class="built_in">key</span> field1 value1 field2 value2 åŒæ—¶è®¾ç½®å¤šä¸ªé”®å’Œå€¼</span><br><span class="line">hget <span class="built_in">key</span> field  æŸ¥çœ‹æŒ‡å®šçš„é”®å¯¹åº”çš„å€¼</span><br><span class="line">hmget <span class="built_in">key</span> fieldl field2 åŒæ—¶æŸ¥çœ‹å¤šä¸ªé”®å’Œå€¼</span><br><span class="line">hgetall <span class="built_in">key</span> è·å–æ‰€æœ‰çš„å€¼å’Œé”®</span><br><span class="line">hkeys <span class="built_in">key</span> è·å–æ‰€æœ‰çš„é”®</span><br><span class="line">hvals <span class="built_in">key</span> è·å–æ‰€æœ‰çš„å€¼</span><br><span class="line">hexists <span class="built_in">key</span> filed åˆ¤æ–­æ˜¯å¦å­˜åœ¨å¯¹åº”çš„å€¼</span><br></pre></td></tr></table></figure>

<h2 id="3-åˆ—è¡¨-list"><a href="#3-åˆ—è¡¨-list" class="headerlink" title="3.åˆ—è¡¨ - list"></a>3.åˆ—è¡¨ - list</h2><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">lpush <span class="keyword">list</span> value1 value2 ... æ’å…¥åˆ°æœ€å·¦è¾¹</span><br><span class="line">rpush <span class="keyword">list</span> value1 value2 ... æ’å…¥åˆ°æœ€å³è¾¹</span><br><span class="line">lpop <span class="keyword">list</span> å–æœ€å·¦è¾¹</span><br><span class="line">rpop <span class="keyword">list</span> å–æœ€å³è¾¹</span><br><span class="line"><span class="keyword">lrange</span> <span class="keyword">list</span> start end æŸ¥çœ‹åˆ—è¡¨ç‰‡æ®µ</span><br><span class="line"><span class="keyword">lindex</span> <span class="keyword">list</span> index æŸ¥çœ‹æŒ‡å®šä¸‹æ ‡å¯¹åº”çš„å…ƒç´ </span><br><span class="line">llen <span class="keyword">list</span> åˆ—è¡¨é•¿åº¦</span><br><span class="line">lrem <span class="keyword">list</span> count value åˆ é™¤æŒ‡å®šä¸ªæ•°çš„å…ƒç´ </span><br></pre></td></tr></table></figure>
<h2 id="4-é›†åˆ-set"><a href="#4-é›†åˆ-set" class="headerlink" title="4.é›†åˆ - set"></a>4.é›†åˆ - set</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sadd <span class="keyword">set</span> value1 value2 <span class="string">...</span> æ·»åŠ å…ƒç´ </span><br><span class="line">srem <span class="keyword">set</span> value ç§»é™¤å…ƒç´ </span><br><span class="line">spop <span class="keyword">set</span> è·å–éšæœºå…ƒç´ </span><br><span class="line">smembers <span class="keyword">set</span> æŸ¥çœ‹æ‰€æœ‰å…ƒç´ </span><br><span class="line">sismember <span class="keyword">set</span> value æŸ¥çœ‹å…ƒç´ æ˜¯å¦åœ¨é›†åˆå†…</span><br><span class="line">scard <span class="keyword">set</span> æŸ¥çœ‹å…ƒç´ ä¸ªæ•°</span><br><span class="line">sinter <span class="keyword">set</span>1 <span class="keyword">set</span>2 äº¤é›†</span><br><span class="line">sunion <span class="keyword">set</span>1 <span class="keyword">set</span>2 å¹¶é›†</span><br><span class="line">sdiff <span class="keyword">set</span>1 <span class="keyword">set</span>2 å·®é›†</span><br></pre></td></tr></table></figure>
<h2 id="5-æœ‰åºé›†åˆ-zset-å…ƒç´ è‡ªå¸¦ä¸€ä¸ªå€¼-å¯ä»¥ä¿®æ”¹"><a href="#5-æœ‰åºé›†åˆ-zset-å…ƒç´ è‡ªå¸¦ä¸€ä¸ªå€¼-å¯ä»¥ä¿®æ”¹" class="headerlink" title="5.æœ‰åºé›†åˆ - zset(å…ƒç´ è‡ªå¸¦ä¸€ä¸ªå€¼,å¯ä»¥ä¿®æ”¹)"></a>5.æœ‰åºé›†åˆ - zset(å…ƒç´ è‡ªå¸¦ä¸€ä¸ªå€¼,å¯ä»¥ä¿®æ”¹)</h2><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">zadd zset score1 mem1 score2 mem2 ... æ·»åŠ </span><br><span class="line">zrem zset mem ç§»é™¤</span><br><span class="line">zrange zset start <span class="keyword">end</span> æŒ‰<span class="symbol">score</span>å‡åºæŸ¥çœ‹</span><br><span class="line">zrevrange zset start <span class="keyword">end</span> æŒ‰<span class="symbol">score</span>é™åºæŸ¥çœ‹</span><br><span class="line">zscore zset mem æŸ¥çœ‹<span class="symbol">score</span>å€¼</span><br><span class="line">zincrby zset value mem æ”¹å˜<span class="symbol">score</span>çš„å€¼</span><br></pre></td></tr></table></figure>
<h2 id="6-åœ°ç†ä½ç½®-LBSåº”ç”¨-Location-Based-Service-åŸºäºä½ç½®çš„æœåŠ¡"><a href="#6-åœ°ç†ä½ç½®-LBSåº”ç”¨-Location-Based-Service-åŸºäºä½ç½®çš„æœåŠ¡" class="headerlink" title="6.åœ°ç†ä½ç½®(LBSåº”ç”¨-Location-Based Service - åŸºäºä½ç½®çš„æœåŠ¡)"></a>6.åœ°ç†ä½ç½®(LBSåº”ç”¨-Location-Based Service - åŸºäºä½ç½®çš„æœåŠ¡)</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">geoadd zset longitude1 latitude1 member1 longitude2 latitude2 member2 <span class="built_in">..</span>.   æ·»åŠ ç»çº¬åº¦ä¿¡æ¯</span><br><span class="line">geopos zset member1 member2 <span class="built_in">..</span>. è·å–æŒ‡å®šçš„ä½ç½®çš„ç»çº¬åº¦</span><br><span class="line">geodist zset member1 member2 [unit] è®¡ç®—ä¸¤ç‚¹é—´çš„è·ç¦»,é»˜è®¤å•ä½æ˜¯ç±³,[unit]æ˜¯å•ä½,å¯ä»¥ä¿®æ”¹ä¸ºm,km,miè‹±é‡Œ,ftè‹±å°º</span><br><span class="line">georadius zset longitude1 latitude1<span class="built_in"> radius </span>m/km/mi/ft è·å–ä»¥ç‚¹zsetä¸ºåœ†å¿ƒ,radiusä¸ºåŠå¾„çš„åœ†çš„èŒƒå›´å†…çš„æ‰€æœ‰çš„åæ ‡ç‚¹;åé¢åŠ withdist,å¯åŒæ—¶è·å–è·ç¦»,åŠ withcoord,å¯åŒæ—¶è·å–ç‚¹çš„ç»çº¬åº¦</span><br></pre></td></tr></table></figure>


<h1 id="åŠ å¯†æŠ€æœ¯"><a href="#åŠ å¯†æŠ€æœ¯" class="headerlink" title="åŠ å¯†æŠ€æœ¯"></a>åŠ å¯†æŠ€æœ¯</h1><p><strong>å¯¹ç§°åŠ å¯† : åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥ - AES<br>éå¯¹ç§°åŠ å¯† : åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ä¸åŒçš„å¯†é’¥(å…¬é’¥å’Œç§é’¥)  -  é€‚åˆäº’è¿ç½‘ - RSA</strong></p>
<p><strong>å…å¯†æ“ä½œ</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ssh-keygen</span> <span class="selector-tag">-t</span> <span class="selector-tag">rsa</span> <span class="selector-tag">-b</span> 2048 <span class="selector-tag">-c</span> <span class="selector-tag">anjhon</span><span class="keyword">@163</span>.com   -   ç”Ÿæˆå…¬é’¥å’Œç§é’¥</span><br><span class="line">t æŒ‡å®šç®—æ³•; <span class="selector-tag">b</span> æŒ‡å®šå¼ºåº¦; <span class="selector-tag">c</span> æŒ‡å®šé‚®ç®±</span><br><span class="line"></span><br><span class="line">è¿›å…¥åˆ°<span class="selector-class">.ssh</span>æ–‡ä»¶,</span><br><span class="line"><span class="selector-tag">id_rsa</span>  <span class="selector-tag">-</span>   ç§é’¥</span><br><span class="line"><span class="selector-tag">id_rsa</span><span class="selector-class">.pub</span>  <span class="selector-tag">-</span>   å…¬é’¥</span><br><span class="line"></span><br><span class="line">å°†å…¬é’¥å¤åˆ¶åˆ°ç½‘ç«™çš„å…¬é’¥è®¾ç½®</span><br><span class="line"></span><br><span class="line">è‹¥æœ‰<span class="selector-tag">known-hosts</span>æ–‡ä»¶,ä¸”ç½‘ç«™é“¾æ¥ä¸ä¸Š,ç›´æ¥åˆ é™¤<span class="selector-tag">known-hosts</span>æ–‡ä»¶</span><br></pre></td></tr></table></figure>



<h1 id="Pythonä¸­çš„redis"><a href="#Pythonä¸­çš„redis" class="headerlink" title="Pythonä¸­çš„redis"></a>Pythonä¸­çš„redis</h1><p><strong>è¿æ¥redisæœåŠ¡å™¨:</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">redis.Redis(<span class="attribute">host</span>=<span class="string">''</span>, <span class="attribute">password</span>=<span class="string">''</span>, <span class="attribute">prot</span>=<span class="string">''</span>)</span><br><span class="line">	host : redisæ‰€åœ¨æœåŠ¡å™¨å…¬ç½‘åœ°å€;</span><br><span class="line">	password : ç™»å½•å£ä»¤;</span><br><span class="line"><span class="built_in">	port </span>: redisçš„æœåŠ¡ç«¯å£</span><br><span class="line">	</span><br><span class="line">è¿æ¥æ—¶ä¼šè¿”å›ä¸€ä¸ªè¿æ¥å¯¹è±¡:</span><br><span class="line">redis_cli = redis.Redis(<span class="attribute">host</span>=<span class="string">''</span>, <span class="attribute">password</span>=<span class="string">''</span>, <span class="attribute">prot</span>=<span class="string">''</span>)</span><br><span class="line">ä½¿ç”¨rediså®Œæˆç›¸åº”çš„æ“ä½œ</span><br></pre></td></tr></table></figure>

<p><strong>pythonä¸­ä½¿ç”¨redisçš„æ•°æ®ç±»å‹:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis   <span class="comment"># å¯¼å…¥redisæ¨¡å—</span></span><br><span class="line"></span><br><span class="line">redis_cli = redis.Redis(host=<span class="string">'10.10.10.10'</span>, password=<span class="string">'123456'</span>, port=<span class="string">'6379'</span>)   <span class="comment"># è¿æ¥redisæœåŠ¡å™¨</span></span><br><span class="line"><span class="comment"># print(redis_cli)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> redis_cli.ping():</span><br><span class="line">    <span class="comment"># hashçš„ä½¿ç”¨</span></span><br><span class="line">    redis_cli.hmset(<span class="string">'stu1'</span>, &#123;</span><br><span class="line">        <span class="string">'stuname'</span>: <span class="string">'xiaoming'</span>,</span><br><span class="line">        <span class="string">'stuid'</span>: <span class="string">'001'</span>,</span><br><span class="line">        <span class="string">'stusex'</span>: <span class="string">'1'</span>,</span><br><span class="line">        <span class="string">'stuaddr'</span>: <span class="string">'è‚–å®¶æ²³'</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    print(redis_cli.hget(<span class="string">'stu1'</span>, <span class="string">'stuname'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æœ‰åºé›†åˆçš„ä½¿ç”¨</span></span><br><span class="line">    redis_cli.zadd(<span class="string">'zset1'</span>, &#123;</span><br><span class="line">        <span class="string">'an'</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="string">'yong'</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="string">'duan'</span>: <span class="number">300</span></span><br><span class="line">    &#125;)</span><br><span class="line">    items = redis_cli.zrevrange(<span class="string">'zset1'</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">    print(list(map(bytes.decode, items)))</span><br><span class="line">    print(redis_cli.zscore(<span class="string">'zset1'</span>, <span class="string">'an'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ—è¡¨çš„ä½¿ç”¨</span></span><br><span class="line">    redis_cli.rpush(<span class="string">'list1'</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">    list1 = redis_cli.lrange(<span class="string">'list1'</span>, <span class="number">0</span>, <span class="number">-1</span>)</span><br><span class="line">    print(list(map(int, list1)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å­—ç¬¦ä¸²çš„ä½¿ç”¨</span></span><br><span class="line">    redis_cli.set(<span class="string">'username'</span>, <span class="string">'an'</span>)</span><br><span class="line">    print(redis_cli.ttl(<span class="string">'username'</span>))</span><br><span class="line">    print(redis_cli.get(<span class="string">'username'</span>).decode(<span class="string">'utf-8'</span>))</span><br><span class="line">    redis_cli.set(<span class="string">'user_age'</span>, <span class="string">'25'</span>)</span><br><span class="line">    redis_cli.set(<span class="string">'user_tel'</span>, <span class="string">'133'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'è¿æ¥å¤±è´¥'</span>)</span><br></pre></td></tr></table></figure>

<p><strong>æ‰©å±•:</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">freeze</span> &gt; requirement.txt   å°†è™šæ‹Ÿç¯å¢ƒä¾èµ–é¡¹å†™å…¥åˆ°æ–‡ä»¶</span><br><span class="line">pip install -r requirement.txt   æŒ‰ç…§æ–‡ä»¶å®‰è£…ä¾èµ–é¡¹</span><br><span class="line"></span><br><span class="line">åºåˆ—åŒ–:  æŠŠä¸€ä¸ªå¯¹è±¡å˜æˆå­—ç¬¦ä¸²(str)æˆ–å­—èŠ‚ä¸²(bytes)</span><br><span class="line">ååºåˆ—åŒ–:  æŠŠå­—ç¬¦ä¸²æˆ–è€…å­—èŠ‚ä¸²è¿˜åŸæˆå¯¹è±¡</span><br><span class="line"><span class="type">json</span>.dumps()   åºåˆ—åŒ–(å­—ç¬¦ä¸²è½¬æ¢æˆå­—èŠ‚ä¸²)</span><br><span class="line"><span class="type">json</span>.loads()   ååºåˆ—åŒ–(å­—èŠ‚ä¸²è½¬æ¢æˆå­—ç¬¦ä¸²)</span><br><span class="line">pickle.dumps()   åºåˆ—åŒ–(å­—ç¬¦ä¸²è½¬æ¢æˆå­—èŠ‚ä¸²)</span><br><span class="line">pickle.loads()   ååºåˆ—åŒ–(å­—èŠ‚ä¸²è½¬æ¢æˆå­—ç¬¦ä¸²)</span><br></pre></td></tr></table></figure>
<p><strong>æ•°æ®ä¸Šä¼ redisæœåŠ¡å™¨å¹¶ä»redisè·å–æ•°æ®</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, addr)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.addr = addr</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span>   <span class="comment"># é­”æ³•æ–¹æ³•(å°†æ•°æ®æ˜¾ç¤ºå‡ºæ¥)</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">'%s, %d, %s, %s'</span> % (self.name, self.age, self.sex, self.addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu1 = Student(<span class="string">'å°æ˜'</span>, <span class="number">20</span>, <span class="string">'ç”·'</span>, <span class="string">'æ˜†æ˜'</span>)</span><br><span class="line">stu2 = Student(<span class="string">'å°é»„'</span>, <span class="number">30</span>, <span class="string">'å¥³'</span>, <span class="string">'ä¸Šæµ·'</span>)</span><br><span class="line"></span><br><span class="line">list1 = [stu1, stu2]   <span class="comment"># å°†å­¦ç”Ÿå¯¹è±¡æ·»åŠ åˆ°åˆ—è¡¨ä¸­</span></span><br><span class="line"></span><br><span class="line">redis_cli = redis.Redis(host=<span class="string">'10.10.10.10'</span>, password=<span class="string">'123456'</span>, port=<span class="string">'6379'</span>)   <span class="comment"># è¿æ¥redisæœåŠ¡å™¨</span></span><br><span class="line"><span class="keyword">if</span> redis_cli.ping():</span><br><span class="line">    <span class="comment"># redis_cli.set('student_all', pickle.dumps(list1))   -   å°†æœ¬åœ°çš„æ•°æ®æ·»åŠ åˆ°redis</span></span><br><span class="line">    redis_stu = pickle.loads(redis_cli.get(<span class="string">'student_all'</span>))   <span class="comment"># è·å–rediså†…çš„æ•°æ®å¹¶è¿›è¡Œååºåˆ—åŒ–</span></span><br><span class="line">    print(redis_stu)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'è¿æ¥å¤±è´¥'</span>)</span><br></pre></td></tr></table></figure>

<p><strong>å°†redisä½œä¸ºç”¨æˆ·è¯·æ±‚å’Œæ•°æ®åº“ä¹‹é—´çš„ç¼“å­˜ä»‹è´¨</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">load_depts_from_db</span><span class="params">()</span>:</span></span><br><span class="line">    conn = pymysql.connect(   <span class="comment"># è¿æ¥æœ¬åœ°çš„MySQLæœåŠ¡å™¨</span></span><br><span class="line">        host=<span class="string">'localhost'</span>,</span><br><span class="line">        port=<span class="number">3306</span>,</span><br><span class="line">        user=<span class="string">'root'</span>,</span><br><span class="line">        password=<span class="string">'123456'</span>,</span><br><span class="line">        charset=<span class="string">'utf8'</span>,</span><br><span class="line">        autocommit=<span class="literal">True</span>,</span><br><span class="line">        database=<span class="string">'hrs'</span></span><br><span class="line">    )</span><br><span class="line">    depts = ()</span><br><span class="line">    <span class="keyword">try</span>:   <span class="comment"># å¼‚å¸¸æ•è·</span></span><br><span class="line">        <span class="keyword">with</span> conn.cursor() <span class="keyword">as</span> cursor:</span><br><span class="line">            cursor.execute(<span class="string">'select dno, dname, dloc from tb_dept'</span>)   <span class="comment"># è·å–æ•°æ®</span></span><br><span class="line">            depts = cursor.fetchall()</span><br><span class="line">    <span class="keyword">except</span> pymysql.MySQLError <span class="keyword">as</span> err:</span><br><span class="line">        print(err)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        conn.close()</span><br><span class="line">    <span class="keyword">return</span> depts</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    redis_cli = redis.Redis(host=<span class="string">'10.10.10.10'</span>, password=<span class="string">'123456'</span>, port=<span class="string">'6379'</span>)</span><br><span class="line">    start = time.time()</span><br><span class="line">    data = redis_cli.get(<span class="string">'depts'</span>)   <span class="comment"># è·å–redisçš„deptså¯¹åº”çš„æ•°æ®</span></span><br><span class="line">    <span class="keyword">if</span> data:</span><br><span class="line">        depts = pickle.loads(data)   <span class="comment"># è‹¥è·å–åˆ°æ•°æ®,å°†æ•°æ®ååºåˆ—åŒ–å¹¶ä¿å­˜ä¸‹æ¥</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        depts = load_depts_from_db()   <span class="comment"># è‹¥æ²¡æœ‰æ•°æ®,ä»æ•°æ®åº“è·å–æ•°æ®,å¹¶å°†æ•°æ®ä¿å­˜åˆ°redisä¸­,ä»¥ä¾¿ä¸‹æ¬¡ä½¿ç”¨æ—¶ä¼˜å…ˆä»redisä¸­è·å–,ä»¥å‡è½»æœåŠ¡å™¨çš„å‹åŠ›å¹¶ä¸”æé«˜æ•°æ®è·å–æ•ˆç‡</span></span><br><span class="line">        redis_cli.set(<span class="string">'depts'</span>, pickle.dumps(depts))</span><br><span class="line"></span><br><span class="line">    end = time.time()</span><br><span class="line">    print(depts)</span><br><span class="line">    print(<span class="string">f'æ‰§è¡Œæ—¶é—´: <span class="subst">&#123;end - start&#125;</span>ç§’'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>


        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>æ–‡ç« ä½œè€…:</span>
                        <span>Anjhon</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>æ–‡ç« åœ°å€:</span>
                        <span><a href="https://anjhon1994.github.io/2019/12/27/radis/">RedisåŠå…¶åº”ç”¨</a></span>
                    </p>
                
                
                
                     <p class="copyright-item">
                         <span>çµé­‚æ‹·é—®:</span>
                         <span>Do you believe in <strong>DESTINY<strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>æ–‡ç« æ ‡ç­¾:</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">â–¼ åŸºç¡€</a>
                    
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">â–¼ æ•°æ®åº“</a>
                    
                        <a href="/tags/redis/">â–¼ redis</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">ã€è¿”å›ä¸Šä¸€å±‚ã€‘</a>
                <span>Â· </span>
                <a href="/">ã€å»å¾€é¦–é¡µã€‘</a>
            </div>
        </section>
        <section class="post-nav">
            	
                <a class="prev" rel="prev" href="/2019/12/28/%E6%B5%85%E6%B5%85%E6%B5%85%E8%B0%88%E6%95%B0%E6%8D%AE%E5%BA%93/">ä¸Šä¸€ç¯‡ï¼šæµ…æµ…æµ…è°ˆæ•°æ®åº“</a>
            
            
            <a class="next" rel="next" href="/2019/12/25/SQL%E5%9F%BA%E7%A1%80/">ä¸‹ä¸€ç¯‡ï¼šMySQLåŸºç¡€</a>
            
			<br>

        </section>


		<br>
		
		
			<span>ç•™ä¸‹ä½ çš„ç—•è¿¹ğŸ˜€</span>
			<section id="comments" class="comments">
			  <style>
				.comments{margin:10px;padding:10px;background:#fff;bordercolor:0,0,0}
				@media screen and (max-width:900px){.comments{margin:auto;padding:20px;background:#fff;bordercolor:0,0,0}}
			  </style>
			  <div id="vcomment" class="comment"></div> 
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script src="https://cdnjs.loli.net/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>
    var notify = 'false' == true ? true : false;
    var verify = 'false' == true ? true : false;
    new Valine({
        av: AV,
        el: '#vcomment',
        notify: notify,
        app_id: "d8Xy9CoRkV8wkjgNsf6IRqfe-gzGzoHsz",
        app_key: "ePiIX7dqVFpzeKkr4T1ixiah",
        placeholder: "ğŸˆğŸˆğŸˆ Just say say ...",
        avatar:"robohash",

		
		
		
    });
</script>

			</section>
		
		


    </article>
</div>





			
        </div>
		
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© 
		Anjhon | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a>
		
		
		
		
		</span>
    </div>
</footer>

    </div>
	
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/ Relative)","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":180,"height":350},"mobile":{"show":false},"react":{"opacityDefault":0.7}});</script></body>
</html>
