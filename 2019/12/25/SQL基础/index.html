<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Anjhon">


    <meta name="subtitle" content="小安">


    <meta name="description" content="没有做不到的事,只是看你想不想做">



<title>MySQL基础 | Anjhon</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 4.1.1"></head>
<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Anjhon&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">博文</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="/about">关于</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>

        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Anjhon&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">博文</a>
                
                    <a class="menu-item" href="/category">分类</a>
                
                    <a class="menu-item" href="/tag">标签</a>
                
                    <a class="menu-item" href="/about">关于</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
        <div class="main">
            <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    document.ready(
        function () {
            tocbot.init({
                tocSelector: '.tocbot-list',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4, h5',
                collapseDepth: 1,
                orderedList: false,
                scrollSmooth: true,
            })
        }
    )

    function expand_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 6,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "collapse_toc()");
        b.innerHTML = "Collapse all"
    }

    function collapse_toc() {
        var b = document.querySelector(".tocbot-toc-expand");
        tocbot.init({
            tocSelector: '.tocbot-list',
            contentSelector: '.post-content',
            headingSelector: 'h1, h2, h3, h4, h5',
            collapseDepth: 1,
            orderedList: false,
            scrollSmooth: true,
        });
        b.setAttribute("onclick", "expand_toc()");
        b.innerHTML = "Expand all"
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">MySQL基础</h1>
            
                <div class="post-meta">
                    <br>
                    
                        作者: <a itemprop="author" rel="author" href="/">&nbsp;&nbsp;Anjhon</a>
                    

                    
                        <p class="post-time">
                        发表: <a href="#">&nbsp;&nbsp;2019-12-25</a>
                        </p>
                    
                    
                        <p class="post-category">
                    分类:
                            
                                <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">&nbsp;&nbsp;数据库</a>
                            
                            </p>
                    
                </div>
            
        </header>

        <div class="post-content">
            <p>关系型数据库之MySQL</p>
<a id="more"></a>



<h1 id="SQL基础"><a href="#SQL基础" class="headerlink" title="SQL基础"></a>SQL基础</h1><p>SQL又叫结构化查询语言,分为三大类,分别是:DDL(数据定义语言),DML(数据操作语言),DCL(数据控制语言)<br>DDL:create(创建数据库和表)、drop(删除数据库和表)、alter(修改表)<br>DML:insert(增)、delete(删)、update(改)、select(查)<br>DCL:grant(授权)、revoke(召回授权)</p>
<p>sql的注释是在注释前加–<br>sql中sql的关键字不区分大小写<br>sq语句结束后需要加分号</p>
<h1 id="DDL-数据定义"><a href="#DDL-数据定义" class="headerlink" title="DDL(数据定义)"></a>DDL(数据定义)</h1><h2 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h2><h3 id="1-创建数据库"><a href="#1-创建数据库" class="headerlink" title="1.创建数据库"></a>1.创建数据库</h3><p>CREATE DATABASE 数据库名称;   —&gt; 创建指定数据库，如果这个数据库已经存在，会报错<br><strong>CREATE DATABASE IF NOT EXISTS 数据库名称;    —&gt; 当指定数据库不存在的时候创建对应的数据库</strong><br>CREATE DATABASE IF NOT EXISTS 数据库名称 DEFAULT CHARSET utf8;    —&gt; 创建数据库的时候指定数据文件编码方式<br>CREATE DATABASE school;</p>
<h3 id="2-删除数据库"><a href="#2-删除数据库" class="headerlink" title="2.删除数据库"></a>2.删除数据库</h3><p><strong>DROP DATABASE 数据库名称;</strong><br><strong>DROP DATABASE IF EXISTS 数据库名;</strong><br>DROP DATABASE school;<br>DROP DATABASE IF EXISTS school;</p>
<h3 id="3-切换-使用数据库"><a href="#3-切换-使用数据库" class="headerlink" title="3.切换/使用数据库"></a>3.切换/使用数据库</h3><p><strong>USE 数据库;  -&gt;   切换/使用指定数据库；切换后所有数据库相关操作都是针对这个数据库</strong><br>USE school;</p>
<h2 id="数据表操作"><a href="#数据表操作" class="headerlink" title="数据表操作"></a>数据表操作</h2><h3 id="1-创建表（数据库文件是通过表来存数据）"><a href="#1-创建表（数据库文件是通过表来存数据）" class="headerlink" title="1.创建表（数据库文件是通过表来存数据）"></a>1.创建表（数据库文件是通过表来存数据）</h3><p><strong>CREATE TABLE IF NOT EXISTS 表名(字段名1 类型1 约束1, 字段名2 类型2 约束2, …);</strong><br><strong>说明:</strong><br>①:表名:程序员自己命名,见名知义,一般需要加前缀t_/tb_示表<br>②:字段名:程序员自己命名,见名知义;注意:字段中一定要有一个字段来作为主键(可以表示唯一一条记录);主键要求不为空,并且是唯一的,而且数据类型是整型<br>③:类型名:必须是当前数据库支持的数据类型,mysql中常用的数据类型:int(整型),float(浮点型),varchar(字符串)/text(字符串),bit(布尔),date/datet ime(日期和时间)<br>④:约束:not null(非空约束)、unique(唯一约束)、default(默认值约束)、primary key(主键约束)、foreign key(外键约束)、auto_increment(自动增长)<br>      注意:约束可以没有,也可以有多个</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> tb_student</span><br><span class="line">(</span><br><span class="line">stuid <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> auto_increment,</span><br><span class="line">stuname <span class="built_in">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">stubirth <span class="built_in">DATE</span>,</span><br><span class="line">stugender <span class="built_in">bit</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">stutel <span class="built_in">VARCHAR</span>(<span class="number">11</span>) <span class="keyword">UNIQUE</span></span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (stuid)  主键约束还可以单独设置</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="2-删除表"><a href="#2-删除表" class="headerlink" title="2.删除表"></a>2.删除表</h3><p><strong>DROP TABLE IF EXISTS 表名;</strong><br>DROP TABLE IF EXISTS tb_student;</p>
<h3 id="3-修改表"><a href="#3-修改表" class="headerlink" title="3.修改表"></a>3.修改表</h3><h4 id="3-1-添加字段"><a href="#3-1-添加字段" class="headerlink" title="3.1 添加字段"></a>3.1 添加字段</h4><p><strong>ALTER TABLE 表名 ADD COLUMN 字段名 类型 约束;</strong><br>ALTER TABLE tb_student ADD COLUMN stuaddr VARCHAR(200);  </p>
<h4 id="3-2-删除字段"><a href="#3-2-删除字段" class="headerlink" title="3.2 删除字段"></a>3.2 删除字段</h4><p><strong>ALTER TABLE 表明 DROP COLUMN 字段名;</strong><br>ALTER TABLE tb_student DROP COLUMN stuaddr;</p>
<h4 id="3-3-修改字段名"><a href="#3-3-修改字段名" class="headerlink" title="3.3 修改字段名"></a>3.3 修改字段名</h4><p><strong>ALTER TABLE 表名 CHANGE 原字段 新字段 新类型;</strong><br>ALTER TABLE tb_student CHANGE tel stutel VARCHAR(11);</p>
<h4 id="3-4-添加约束"><a href="#3-4-添加约束" class="headerlink" title="3.4 添加约束"></a>3.4 添加约束</h4><p><strong>3.4.1 创建表或添加字段的时候直接在字段后面添加约束</strong><br><strong>3.4.2 通过修改表的样式添加约束</strong><br><strong>ALTER TABLE 表名 ADD CONSTRAINT 约束索引名 约束名(字段);   -&gt;   给指定字段添加指定约束</strong><br><strong>ALTER TABLE 表1 ADD CONSTRAINT 约束索引名 FOREIGN KEY(字段1) REFERENCES 表2(字段2);   -&gt;   给表1中的字段1添加外键约束,并且字段1的值依赖表2中的字段2</strong></p>
<h4 id="3-5-删除约束"><a href="#3-5-删除约束" class="headerlink" title="3.5 删除约束"></a>3.5 删除约束</h4><p><strong>ALTER TABLE 表名 DROP INDEX 约束索引名;   -&gt;   删除指定约束</strong><br><strong>ALTER TABLE 表名 DROP FOREIGN KEY 外键索引;   -&gt;   删除外键约束</strong></p>
<h1 id="0ML-数据操作"><a href="#0ML-数据操作" class="headerlink" title="0ML(数据操作)"></a>0ML(数据操作)</h1><h2 id="1-INSERT-增"><a href="#1-INSERT-增" class="headerlink" title="1.INSERT(增)"></a>1.INSERT(增)</h2><p><strong>方法①:INSERT INTO 表名 VALUES(值1, 值2, 值3,…)  -&gt; 按表中字段的顺序依次给每个字段赋值,最终形成一条新的记录</strong><br>说明: 日期(DATE)  -&gt;  1)日期字符串:如: ‘2019-12-23’<br>                               2)DATE((NOW())-当前日期; YEAR(NOW())-当前年; MONTH(NOW())-当前月;</p>
<p>INSERT INTO tb_student VALUES(1, ‘天明’, ‘2000-10-2’, 1, ‘12345678901’);</p>
<p><strong>方法②:INSERT INTO 表名(字段名1,字段名2,…) VALUES(值1,值2,…);  -&gt;  按指定顺序给指定字段赋值,最终形成一条新的记录</strong></p>
<p>INSERT INTO tb_student(stuname, stubirth, stugender, stutel) VALUES(‘少羽’, ‘2000-8-21’, 1, ‘12345678902’);</p>
<p><strong>方法③:INSERT INTO 表名(字段名1,字段名2,…) VALUES(值1,值..…),(值11,值22,..),(值111,值2222,…),…;  -&gt;  同时插入多条记录</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tb_student(stuname, stubirth, stugender, stutel) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">'月儿'</span>, <span class="string">'2000-11-21'</span>, <span class="number">0</span>, <span class="string">'12345678903'</span>),</span><br><span class="line">(<span class="string">'卫庄'</span>, <span class="string">'1989-8-21'</span>, <span class="number">1</span>, <span class="string">'12345678904'</span>),</span><br><span class="line">(<span class="string">'盖聂'</span>, <span class="string">'1990-8-21'</span>, <span class="number">1</span>, <span class="string">'12345678905'</span>),</span><br><span class="line">(<span class="string">'胜七'</span>, <span class="string">'1977-8-21'</span>, <span class="number">1</span>, <span class="string">'12345678906'</span>),</span><br><span class="line">(<span class="string">'惊鲵'</span>, <span class="string">'1971-8-21'</span>, <span class="number">0</span>, <span class="string">'12345678907'</span>),</span><br><span class="line">(<span class="string">'掩日'</span>, <span class="string">'1972-8-21'</span>, <span class="number">1</span>, <span class="string">'12345678908'</span>),</span><br><span class="line">(<span class="string">'黑白玄鉴'</span>, <span class="string">'1970-8-21'</span>, <span class="number">1</span>, <span class="string">'12345678909'</span>),</span><br><span class="line">(<span class="string">'真刚'</span>, <span class="string">'1973-8-25'</span>, <span class="number">1</span>, <span class="string">'12345678910'</span>),</span><br><span class="line">(<span class="string">'断水'</span>, <span class="string">'1974-8-21'</span>, <span class="number">1</span>, <span class="string">'12345678911'</span>),</span><br><span class="line">(<span class="string">'赵高'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678912'</span>),</span><br><span class="line">(<span class="string">'韩非'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678913'</span>),</span><br><span class="line">(<span class="string">'韩信'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678914'</span>),</span><br><span class="line">(<span class="string">'章邯'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678915'</span>),</span><br><span class="line">(<span class="string">'鬼谷子'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678916'</span>),</span><br><span class="line">(<span class="string">'东皇太一'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678917'</span>),</span><br><span class="line">(<span class="string">'晓梦'</span>, <span class="string">'1976-8-31'</span>, <span class="number">0</span>, <span class="string">'12345678918'</span>),</span><br><span class="line">(<span class="string">'逍遥子'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678919'</span>),</span><br><span class="line">(<span class="string">'赤炼'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678920'</span>),</span><br><span class="line">(<span class="string">'高渐离'</span>, <span class="string">'1976-8-31'</span>, <span class="number">1</span>, <span class="string">'12345678921'</span>);</span><br></pre></td></tr></table></figure>


<h2 id="2-DELETE-删"><a href="#2-DELETE-删" class="headerlink" title="2.DELETE(删)"></a>2.DELETE(删)</h2><p><strong>方法①:DELETE FROM 表名;  -&gt;   删除当前表中所有的记录(清空表)</strong><br><strong>DELETE FROM tb_student;</strong></p>
<p><strong>方法②:DELETE FROM 表名 WHERE 条件;  -&gt;  删除所有满足条件的记录</strong></p>
<p><strong>补充:</strong><br>sq1条件语句的写法(筛选)(条件语句在写的时候可以通过加()改变运算顺序)</p>
<p><strong>比较运算:=(等于),&lt;&gt;(不等于),&gt;,&lt;,&gt;=,&lt;=</strong><br>DELETE FROM tb_student WHERE stuname=’真刚’;</p>
<p><strong>逻辑运算:and(逻辑与),or(逻辑或),not(逻辑非);</strong><br>DELETE FROM tb_student WHERE stuid&gt;=35 AND stugender&lt;&gt;1;</p>
<p><strong>集合包含:in</strong><br>DELETE FROM tb_student WHERE stuname in (‘逍遥子’, ‘韩信’, ‘断水’);</p>
<p><strong>范围:between…and</strong><br>DELETE FROM tb_student WHERE stubirth BETWEEN ‘1976-8-21’ AND ‘1976-8-31’;</p>
<p><strong>判断是否为空:is null,is not null</strong><br>DELETE FROM tb_student WHERE (stubirth IS NULL) AND (stutel IS NULL);</p>
<p><strong>筛选:like(% -&gt; 任意个任意字符; _  -&gt;  表示单个任意字符)</strong><br>DELETE FROM tb_student WHERE stuname LIKE ‘盖_ ‘;<br>DELETE FROM tb_student WHERE stutel LIKE ‘%2_’;</p>
<h2 id="3-UPDATE-改"><a href="#3-UPDATE-改" class="headerlink" title="3.UPDATE(改)"></a>3.UPDATE(改)</h2><p>ALTER TABLE tb_student ADD COLUMN stuaddr VARCHAR(200);</p>
<p><strong>UPDATE 表名 SET 字段1=新值1,字段2=新值2,…;  -&gt;  将指定表中所有记录中指定的字段修改成指定的值</strong></p>
<p>UPDATE tb_student SET stuaddr=’成都’;</p>
<p><strong>UPDATE 表名 SET 字段1=新值1,字段2=新值2,… WHERE 条件;  -&gt;  将满足条件的记录的指定字段设置为指定的值</strong></p>
<p>UPDATE tb_student SET stuaddr=’昆明’ WHERE stugender=0;</p>
<h2 id="4-SELECT-查"><a href="#4-SELECT-查" class="headerlink" title="4.SELECT(查)"></a>4.SELECT(查)</h2><p><strong>SELECT * FROM 表名;  -&gt;  获取指定表中所有的记录中所有字段的数据</strong></p>
<p>SELECT * FROM tb_student;</p>
<p><strong>映射</strong><br><strong>SELECT 字段1,字段2,字段3,… FROM 表名;  -&gt;  获取表中所有记录指定字段的数据</strong><br>SELECT stuname, stugender, stuaddr FROM tb_student;</p>
<p><strong>列重名</strong><br><strong>SELECT 字段名1 AS ‘新字段名1’, 字段名2,字段名3 AS ‘新字段名3’, … FROM 表名;</strong><br>SELECT stuname AS ‘姓名’, stugender AS ‘性别’, stuaddr AS ‘地址’ from tb_student</p>
<p><strong>结果重新赋值(主要针对布尔)</strong><br><strong>SELECT IF(字段名, 值1, 值2) FROM 表名;   -&gt;   一如果if中对应的字段的值是1,最后结果是值1,否则是值2(mysql特有写法)</strong></p>
<p>SELECT stuname AS ‘姓名’, IF(stugender, ‘男’, ‘女’) AS ‘性别’, stuaddr AS ‘地址’ from tb_student</p>
<p><strong>SELECT CASE 字段 WHEN 1或0 THEN 新值1 ELSE 新值2 END FROM 表名;</strong></p>
<p>SELECT stuname AS ‘姓名’, CASE stugender WHEN 1 THEN ‘男’ ELSE ‘女’ END AS ‘性别’, stuaddr AS ‘地址’ from tb_student</p>
<p><strong>列合并(查询的时候将多个字段合并成一个数据返回结果)</strong><br><strong>SELECT CONCAT(字段1,字段2,…) FROM 表名;</strong><br>SELECT CONCAT(stuname, stuid) as ‘姓名学号’ FROM tb_student;</p>
<p><strong>筛选</strong><br><strong>上面所有的查询语法的后面都可以加’where条件’对记录进行筛选</strong><br><strong>SELECT * FROM 表名 WHERE 条件;</strong><br>SELECT stuname, stutel FROM tb_student WHERE stugender=0;<br>SELECT * FROM tb_student WHERE stuname LIKE ‘月_’</p>
<p><strong>排序</strong><br><strong>SELECT * FROM 表名 ORDER BY 字段;   -&gt;   将查询结果按指定字段的值从小到大排序</strong></p>
<p>SELECT * FROM tb_student ORDER BY stuid;</p>
<p><strong>SELECT * FROM 表名 ORDER BY 字段 ASC;   -&gt;   将查询结果按指定字段的值从小到大排序</strong><br><strong>SELECT * FROM 表名 ORDER BY 字段 DESC;   -&gt;   将查询结果按指定字段的值从大到小排序</strong></p>
<p>SELECT * FROM tb_student ORDER BY stuid DESC;</p>
<p><strong>SELECT * FROM 表名 ORDER BY 字段1 DESC, 字段2 DESC;   -&gt;   将查询结果按指定字段的值从大到小排序</strong></p>
<p>SELECT * FROM tb_student ORDER BY stugender DESC, stubirth;   -&gt;   先按stugender从大到小排序;stugender相同再按stubirth从小到大排序</p>
<h2 id="5-外键约束"><a href="#5-外键约束" class="headerlink" title="5.外键约束"></a>5.外键约束</h2><p>让两个表之间产生联系</p>
<p><strong>添加外键约束的规范:</strong><br>一对一: 可以添加到任意一方;<br>一对多和多对一: 添加到多的一方;<br>多对多: 两张表没有办法直接建立多对多的对应关系,需要第三张表辅助</p>
<h2 id="6-查询中的高级查询"><a href="#6-查询中的高级查询" class="headerlink" title="6.查询中的高级查询"></a>6.查询中的高级查询</h2><h3 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h3><p><strong>SELECT DISTINCT 字段名 FROM 表名;    -&gt;   去除重复的项</strong><br><strong>SELECT DISTINCT redate FROM tb_record;</strong></p>
<h3 id="限制和分页"><a href="#限制和分页" class="headerlink" title="限制和分页"></a>限制和分页</h3><p><strong>限制: SELECT * FROM 表名 LIMIT N;   -&gt;   获取前N条数据</strong><br><strong>SELECT * FROM tb_record LIMIT 5;</strong><br><strong>偏移:</strong><br><strong>①:SELECT * FROM 表名 LIMIT M OFFSET N;   -&gt;   跳过前N条数据获取M条数据(从第N+1条数据开始,获取M条数据)</strong><br><strong>②:SELECT * FROM 表名 LIMIT N, M;   -&gt;   跳过前N条数据获取M条数据(从第N+1条数据开始,获取M条数据)</strong></p>
<h3 id="聚合"><a href="#聚合" class="headerlink" title="聚合"></a>聚合</h3><p><strong>max(), min(), sum(), avg(), count()   -&gt;   MySQL专用</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(score) <span class="keyword">AS</span> <span class="string">'最高分'</span> <span class="keyword">FROM</span> tb_record;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MIN</span>(score) <span class="keyword">AS</span> <span class="string">'最低分'</span> <span class="keyword">FROM</span> tb_record;</span><br><span class="line">SELECT SUM(score) AS '总分' FROM tb_record;   -&gt;   -- 求和所有分数的和,如果某一个记录的分数是空,那么这条记录不存与运算</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">AVG</span>(score) <span class="keyword">AS</span> <span class="string">'平均分'</span> <span class="keyword">FROM</span> tb_record;  </span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(score) <span class="keyword">AS</span> <span class="string">'个数'</span> <span class="keyword">FROM</span> tb_record;</span><br></pre></td></tr></table></figure>

<h3 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h3><p><strong>SELECT 聚合操作 FROM 表名 GROUP BY (字段);   -&gt;   按指定字段的值对表进行分组,然后对每个分组进行聚合操作</strong><br><strong>注意:</strong><br><strong>①分组后,除了分组字段以外,其他字段只能聚合操作</strong><br><strong>②分组后要加条件,则用having代替where</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取每个学生所有学科的平局分</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sid</span>, <span class="keyword">AVG</span>(score) <span class="keyword">FROM</span> tb_record <span class="keyword">GROUP</span> <span class="keyword">BY</span> (<span class="keyword">sid</span>);</span><br><span class="line"><span class="comment">-- 获取每个学科的平局分</span></span><br><span class="line"><span class="keyword">SELECT</span> cid, <span class="keyword">AVG</span>(score) <span class="keyword">FROM</span> tb_record <span class="keyword">GROUP</span> <span class="keyword">BY</span> (cid);</span><br><span class="line"><span class="comment">-- 获取每个学生选的课程的数量</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sid</span>, <span class="keyword">COUNT</span>(cid) <span class="keyword">FROM</span> tb_record <span class="keyword">GROUP</span> <span class="keyword">BY</span> (<span class="keyword">sid</span>);</span><br></pre></td></tr></table></figure>

<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h3><p><strong>①:将一个查询的结果作为另外一个查询的条件</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 例: 获取成绩是最高分的学生的id</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sid</span>, score <span class="keyword">FROM</span> tb_record <span class="keyword">WHERE</span> score=(<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(score) <span class="keyword">FROM</span> tb_record);</span><br><span class="line"><span class="comment">-- 例: 获取分数最高的三个学生</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sid</span> <span class="keyword">FROM</span> tb_record <span class="keyword">WHERE</span> score <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span>(score) <span class="keyword">FROM</span> tb_record <span class="keyword">ORDER</span> <span class="keyword">BY</span> (score)<span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">3</span>);</span><br><span class="line"><span class="comment">-- 例: 获取选了两门以上的课程的学生id</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">sid</span> <span class="keyword">FROM</span> tb_record <span class="keyword">GROUP</span> <span class="keyword">BY</span> (<span class="keyword">sid</span>) <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(cid)&gt;<span class="number">2</span>;</span><br><span class="line"><span class="comment">-- 例: 获取选了两门以上的课程的学生姓名</span></span><br><span class="line"><span class="keyword">SELECT</span> stuname <span class="keyword">FROM</span> tb_student <span class="keyword">WHERE</span> stuid <span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">sid</span> <span class="keyword">FROM</span> tb_record <span class="keyword">GROUP</span> <span class="keyword">BY</span> (<span class="keyword">sid</span>) <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(cid)&gt;<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p><strong>②:将一个查询的结果作为另外一个查询的对象</strong><br><strong>注: 若将查询结果作为查询对象,则必须在使用时用as重命名</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_student <span class="keyword">LIMIT</span> <span class="number">4</span>,<span class="number">5</span>;</span><br><span class="line"><span class="keyword">SELECT</span> stuname <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_student <span class="keyword">LIMIT</span> <span class="number">4</span>,<span class="number">5</span>) <span class="keyword">AS</span> t1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> stuname <span class="keyword">AS</span> sname, stuaddr <span class="keyword">AS</span> saddr <span class="keyword">FROM</span> tb_student <span class="keyword">WHERE</span> stusex=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">SELECT</span> sname, saddr <span class="keyword">FROM</span> (<span class="keyword">SELECT</span> stuname <span class="keyword">AS</span> sname, stuaddr <span class="keyword">AS</span> saddr <span class="keyword">FROM</span> tb_student <span class="keyword">WHERE</span> stusex=<span class="number">0</span>) <span class="keyword">AS</span> t2 <span class="keyword">WHERE</span> saddr <span class="keyword">LIKE</span> <span class="string">'%成都'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3><h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4><p><strong>①: SELECT * FROM 表名1, 表名2, … WHERE 连接条件 查询条件;</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询部门中薪水最高的人姓名、工资和所在部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> dno, <span class="keyword">MAX</span>(sal) <span class="keyword">FROM</span> tb_emp <span class="keyword">GROUP</span> <span class="keyword">BY</span>(dno);</span><br><span class="line"><span class="keyword">SELECT</span> ename, sal, dname <span class="keyword">FROM</span> tb_emp, tb_dept, (<span class="keyword">SELECT</span> dno <span class="keyword">AS</span> dno2, <span class="keyword">MAX</span>(sal) <span class="keyword">AS</span> max_sal <span class="keyword">FROM</span> tb_emp <span class="keyword">GROUP</span> <span class="keyword">BY</span>(dno)) <span class="keyword">AS</span> t2 <span class="keyword">WHERE</span> tb_emp.dno=tb_dept.dno <span class="keyword">AND</span> tb_emp.dno=t2.dno2 <span class="keyword">AND</span> sal=max_sal;</span><br></pre></td></tr></table></figure>

<p><strong>②: SELECT * FROM t1 INNER JOIN t2 ON 连接条件1 INNER JOIN t3 ON 连接条件2;(注意:如果有中间表,中间表放在最前面)</strong><br><strong>注意:如果既有连接条件又有查询条件,查询条件必须放在连接条件的后面</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询部门中薪水最高的人姓名、工资和所在部门名称</span></span><br><span class="line"><span class="keyword">SELECT</span> ename, sal, dname <span class="keyword">FROM</span> tb_emp <span class="keyword">INNER</span> <span class="keyword">JOIN</span> tb_dept <span class="keyword">ON</span> tb_emp.dno=tb_dept.dno <span class="keyword">INNER</span> <span class="keyword">JOIN</span> (<span class="keyword">SELECT</span> dno <span class="keyword">AS</span> dno2, <span class="keyword">MAX</span>(sal) <span class="keyword">AS</span> max_sal <span class="keyword">FROM</span> tb_emp <span class="keyword">GROUP</span> <span class="keyword">BY</span>(dno)) <span class="keyword">AS</span> t2 <span class="keyword">ON</span> tb_emp.dno=t2.dno2 <span class="keyword">WHERE</span> sal=max_sal;</span><br></pre></td></tr></table></figure>

<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><p><strong>在MySQL中只支持左外连接(LEFT JOIN)和右外连接(right join)</strong></p>
<p><strong>①: 左连接: SELECT * FROM 表1 LEFT JOIN 表2 : 先将表1中的记录全部取出来,按连接条件依次连接表2中的记录,表1中的记录找不到满足条件,则表2记录那么连接的内容就是空</strong></p>
<p><strong>②: 右连接: SELECT * FROM 表1 RIGHT JOIN 表2 : 先将表2中的记录全部取出来,按连接条件依次连接表1中的记录,表2中的记录找不到满足条件,则表1记录那么连接的内容就是空</strong></p>
<h1 id="DCL-数据控制"><a href="#DCL-数据控制" class="headerlink" title="DCL(数据控制)"></a>DCL(数据控制)</h1><p>DCL主要提供授权和授权召回以及视图, 索引等相关功能</p>
<h2 id="用户管理-一般只有root账号有此权限"><a href="#用户管理-一般只有root账号有此权限" class="headerlink" title="用户管理(一般只有root账号有此权限)"></a>用户管理(一般只有root账号有此权限)</h2><p><strong>创建用户</strong><br><strong>CREATE USER ‘用户名‘@’登陆地址’;  -&gt;   创建指定用户,用户登陆时不用输入密码</strong><br><strong>CREATE USER ‘用户名‘@’登陆地址’ identified by ‘密码’;   -&gt;   创建指定用户,用户登陆时需要输入密码</strong><br>说明:<br>登录地址   -&gt;   ip地址<br>                          localhost(本机)<br>                          %(任意位置)</p>
<p><strong>删除用户</strong><br><strong>DROP USER ‘用户名’;</strong></p>
<h2 id="授权管理"><a href="#授权管理" class="headerlink" title="授权管理"></a>授权管理</h2><p><strong>授权</strong><br><strong>GRANT 权限类型 ON 数据库.表 TO ‘用户名‘@’登陆地址’;</strong></p>
<blockquote>
<p>说明:<br>权限类型: insert, delete, update, select,  create, drop, all privilege(所有权限);</p>
</blockquote>
<p><strong>召回权限</strong><br><strong>REVOKE 权限类型 ON 数据库.表 FROM 用户名;</strong></p>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>若完成一个任务需要多个操作,但只要有一个失败则任务不完成,数据回到任务开始前的状态;只有所有操作都成功了,数据库才更新;此时用事务语法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;   <span class="comment">-- 开启事务环境 </span></span><br><span class="line"><span class="keyword">UPDATE</span> tb_student <span class="keyword">SET</span> stubirth=<span class="string">'1993-1-1'</span> <span class="keyword">WHERE</span> stusex=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> tb_student <span class="keyword">WHERE</span> stuname <span class="keyword">LIKE</span> <span class="string">'杨%'</span></span><br><span class="line"><span class="keyword">COMMIT</span>;   <span class="comment">-- 提交事务环境中的操作结果</span></span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br></pre></td></tr></table></figure>

<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p><strong>创建视图:</strong><br><strong>CREATE VIEW 视图名 AS sql查询语句;</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 获取学生学科的成绩</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> vw_stu_score <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> stuid, stuname, couid, couname, score <span class="keyword">FROM</span> tb_student, tb_record, tb_course <span class="keyword">WHERE</span> tb_student.stuid=tb_record.sid <span class="keyword">AND</span> tb_course.couid=tb_record.cid;</span><br></pre></td></tr></table></figure>
<p><strong>使用视图:</strong><br><strong>(视图查询操作和表的查询操作基本一致,一般不增删改)</strong></p>
<blockquote>
<p>应用:<br>方便查询,<br>给权限不够的用户查看表内的部分信息.</p>
</blockquote>
<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><p>索引就像书的目录,记录了数据的位置, 可以提高查询速度;给使用频率高的字段添加索引,(主键自带唯一索引)</p>
<p><strong>添加索引:</strong><br><strong>①: CREATE INDEX 索引名 ON 表名(字段);   -&gt;   给指定字段添加索引</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPLAIN</span> <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> tb_student <span class="keyword">WHERE</span> stuname=<span class="string">'岳不群'</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> idx_stuname <span class="keyword">ON</span> tb_student(stuname);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">INDEX</span> idx_stuaddr <span class="keyword">ON</span> tb_student(stuaddr);</span><br></pre></td></tr></table></figure>
<p><strong>②: CREATE UNIQUE INDEX 索引名 ON 表名(字段);   -&gt;   给指定字段添加唯一索引</strong><br>注意:模糊查询的时候如果以%和_开头则索引无效</p>
<p><strong>删除索引:</strong><br><strong>ALTER TABLE 表名 DROP INDEX 索引名;   -&gt;   删除指定索引</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_student <span class="keyword">DROP</span> <span class="keyword">INDEX</span> idx_stuname;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_student <span class="keyword">DROP</span> <span class="keyword">INDEX</span> idx_stuaddr;</span><br></pre></td></tr></table></figure>









        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>文章作者:</span>
                        <span>Anjhon</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>文章地址:</span>
                        <span><a href="https://anjhon1994.github.io/2019/12/25/SQL%E5%9F%BA%E7%A1%80/">MySQL基础</a></span>
                    </p>
                
                
                
                     <p class="copyright-item">
                         <span>灵魂拷问:</span>
                         <span>Do you believe in <strong>DESTINY<strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">✓ 基础</a>
                    
                        <a href="/tags/MySQL/">✓ MySQL</a>
                    
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">✓ 数据库</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2019/12/27/radis/">Redis及其应用</a>
            
            
            <a class="next" rel="next" href="/2019/12/23/shell%E7%BC%96%E7%A8%8B/">shell编程</a>
            
        </section>


    </article>
</div>

			
        </div>
		
        <footer id="footer" class="footer">
    <div class="copyright">
        <span>© 
		Anjhon | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a>
		
		
		
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


		
		
		</span>
    </div>
</footer>

    </div>
	
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/ Relative)","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"left","width":180,"height":350},"mobile":{"show":false},"react":{"opacityDefault":0.7}});</script></body>
</html>
